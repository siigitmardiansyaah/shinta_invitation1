(()=>{var N=(()=>{let r=null,f=null,p=0,m=0,h=!0,i=()=>{p+=1},d=()=>`(${m}/${p}) [${parseInt(m/p*100).toFixed(0)}%]`;return{init:()=>{r=document.getElementById("progress-info"),f=document.getElementById("progress-bar"),r.style.display="block"},add:i,invalid:S=>{h=!1,f.style.backgroundColor="red",r.innerText=`Error loading ${S} ${d()}`},complete:S=>{h&&(m+=1,r.innerText=`Loading ${S} complete ${d()}`,f.style.width=Math.min(m/p*100,100).toString()+"%",m===p&&document.dispatchEvent(new Event("progress.done")))}}})();var E=(()=>{let r='<span class="spinner-border spinner-border-sm my-0 ms-0 me-1 p-0" style="height: 0.8rem; width: 0.8rem;"></span>',f=s=>String(s).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),p=(s,c)=>new Promise(T=>{let u=parseFloat(s.style.opacity),w=null,$=c?.05:-.05,y=c?1:0;w=setInterval(()=>{u=Math.max(0,Math.min(1,u+$)),s.style.opacity=u.toFixed(2),u===y&&(T(),clearInterval(w),w=null)},10)}),m=(s,c)=>{let T=null;T=setTimeout(()=>{s(),clearTimeout(T),T=null},c)};return{loader:r,copy:async(s,c=null,T=1500)=>{let u=s.getAttribute("data-copy");if(!u||u.length===0){alert("Nothing to copy");return}s.disabled=!0;try{await navigator.clipboard.writeText(u)}catch{s.disabled=!1,alert("Failed to copy");return}let w=s.innerHTML;s.innerHTML=c||'<i class="fa-solid fa-check"></i>',m(()=>{s.disabled=!1,s.innerHTML=w},T)},timeOut:m,debounce:(s,c)=>{let T=null;return(...u)=>{clearTimeout(T),T=setTimeout(()=>s(...u),c)}},escapeHtml:f,base64Encode:s=>{let T=new TextEncoder().encode(s);return window.btoa(String.fromCharCode(...T))},base64Decode:s=>{let c=new TextDecoder,T=Uint8Array.from(window.atob(s),u=>u.charCodeAt(0));return c.decode(T)},disableButton:(s,c="Loading")=>{s.disabled=!0;let T=s.innerHTML;return s.innerHTML=r+c,{restore:()=>{s.innerHTML=T,s.disabled=!1}}},disableCheckbox:s=>{s.disabled=!0;let c=document.querySelector(`label[for="${s.id}"]`),T=c.innerHTML;return c.innerHTML=r+T,{restore:()=>{c.innerHTML=T,s.disabled=!1}}},parseUserAgent:s=>{let c=[{type:"Mobile",regex:/Android.*Mobile|iPhone|iPod|BlackBerry|IEMobile|Opera Mini/i},{type:"Tablet",regex:/iPad|Android(?!.*Mobile)|Tablet/i},{type:"Desktop",regex:/Windows NT|Macintosh|Linux/i}],T=[{name:"Chrome",regex:/Chrome|CriOS/i},{name:"Safari",regex:/Safari/i},{name:"Edge",regex:/Edg|Edge/i},{name:"Firefox",regex:/Firefox|FxiOS/i},{name:"Opera",regex:/Opera|OPR/i},{name:"Internet Explorer",regex:/MSIE|Trident/i}],u=[{name:"Windows",regex:/Windows NT ([\d.]+)/i},{name:"MacOS",regex:/Mac OS X ([\d_]+)/i},{name:"Android",regex:/Android ([\d.]+)/i},{name:"iOS",regex:/OS ([\d_]+) like Mac OS X/i},{name:"Linux",regex:/Linux/i}],w=c.find(a=>a.regex.test(s))?.type||"Unknown",$=T.find(a=>a.regex.test(s))?.name||"Unknown",y=u.find(a=>a.regex.test(s)),L=y&&s.match(y.regex)?.[1]?.replace(/_/g,".")||"",C=y?y.name:"Unknown";return L=L?`${C} ${L}`:C,`${$} ${w} ${L}`},changeOpacity:p}})();var U=(()=>{let r=(c,T,u)=>({code:c,data:T,error:u}),f=(c=0)=>({love:c}),p=({uuid:c,own:T,name:u,presence:w,comment:$,created_at:y,is_admin:L,gif_url:C,ip:a,user_agent:n,comments:e,like:o})=>({uuid:c,own:T,name:u,presence:w,comment:$,created_at:y,is_admin:L??!1,gif_url:C,ip:a,user_agent:n,comments:e?.map(p)??[],like:f(o?.love??0)});return{uuidResponse:({uuid:c})=>({uuid:c}),baseResponse:r,tokenResponse:({token:c})=>({token:c}),statusResponse:({status:c})=>({status:c}),commentResponse:({name:c,presence:T,comment:u,is_admin:w,gif_url:$,created_at:y})=>({name:c,presence:T,comment:u,is_admin:w,gif_url:$,created_at:y}),likeCommentResponse:f,getCommentResponse:p,getCommentsResponse:c=>c.map(p),commentShowMore:(c,T=!1)=>({uuid:c,show:T}),postCommentRequest:(c,T,u,w,$)=>({id:c,name:T,presence:u,comment:w,gif_id:$}),postSessionRequest:(c,T)=>({email:c,password:T}),updateCommentRequest:(c,T,u)=>({presence:c,comment:T,gif_id:u})}})();var j="GET",te="PUT",J="POST",ne="PATCH",oe="DELETE",W=200,Q=201,me=500,D=(r,f)=>{let p=new AbortController,m=document.body.getAttribute("data-url"),h={signal:p.signal,method:String(r).toUpperCase(),headers:new Headers({Accept:"application/json","Content-Type":"application/json"})};return window.addEventListener("offline",()=>p.abort()),window.addEventListener("popstate",()=>p.abort()),window.addEventListener("beforeunload",()=>p.abort()),m.slice(-1)==="/"&&(m=m.slice(0,-1)),{send(i=null){return fetch(m+f,h).then(d=>d.json().then(g=>{if(d.status>=me&&(g.message??g[0]))throw new Error(g.message??g[0]);if(g.error)throw new Error(g.error[0]);return i&&(g.data=i(g.data)),U.baseResponse(g.code,g.data,g.error)})).catch(d=>{if(d.name==="AbortError")return console.warn("Fetch abort:",d),d;throw alert(d),new Error(d)})},download(){return fetch(m+f,h).then(i=>{if(i.status!==W)return!1;let d=document.querySelector("a[download]");d&&document.body.removeChild(d);let g=i.headers.get("content-disposition")?.match(/filename="(.+)"/)?.[1]??"download.csv";return i.blob().then(I=>{let k=document.createElement("a"),S=window.URL.createObjectURL(I);return k.href=S,k.download=g,document.body.appendChild(k),k.click(),document.body.removeChild(k),window.URL.revokeObjectURL(S),!0})}).catch(i=>{if(i.name==="AbortError")return console.warn("Fetch abort:",i),i;throw alert(i),new Error(i)})},withCancel(i){return(async()=>(await i,p.abort()))(),this},default(i=null){return h.headers=new Headers(i??{}),fetch(f,h)},token(i){return i.split(".").length===3?(h.headers.append("Authorization","Bearer "+i),this):(h.headers.append("x-access-key",i),this)},body(i){return h.body=JSON.stringify(i),this}}};var ee=(()=>{let r=null,f=null,p=!1,m=1e3*60*60*6,h="images",i=async s=>{let c=s.getAttribute("data-src"),T="x-expiration-time",u="image/webp",w=new Image;if(w.onload=()=>{s.src=w.src,s.width=w.width,s.height=w.height,w.remove(),N.complete("image")},r.has(c)){w.src=r.get(c);return}let $=C=>new Promise((a,n)=>{let e=document.createElement("canvas");e.width=C.width,e.height=C.height,e.getContext("2d").drawImage(C,0,0);let o=b=>{e.remove(),b?a(b):n(new Error("Failed to convert image to WebP"))};e.onerror=n,e.toBlob(o,u,.8)}),y=(C,a=3,n=1e3)=>D(j,c).default().then(e=>e.blob()).then(e=>window.createImageBitmap(e)).then(e=>$(e)).then(e=>{let o=new Headers;return o.set("Content-Type",u),o.set("Content-Length",String(e.size)),o.set(T,String(Date.now()+m)),C.put(c,new Response(e,{headers:o})).then(()=>e)}).catch(e=>{if(a<=0)throw e;return console.warn("Retrying fetch:"+c),new Promise(o=>E.timeOut(()=>o(y(C,a-1,n+1e3)),n))}),L=C=>C.match(c).then(a=>a?Date.now()<=parseInt(a.headers.get(T))?a.blob():C.delete(c).then(n=>n?y(C):a.blob()):y(C));await caches.open(h).then(C=>L(C)).then(C=>{w.src=URL.createObjectURL(C),r.set(c,w.src)}).catch(()=>N.invalid("image"))},d=s=>{s.onerror=()=>N.invalid("image"),s.onload=()=>{s.width=s.naturalWidth,s.height=s.naturalHeight,N.complete("image")},s.complete&&s.naturalWidth!==0&&s.naturalHeight!==0?N.complete("image"):s.complete&&N.invalid("image")},g=()=>p,I=s=>{m=Number(s)},k=()=>{(async()=>{for(let s of f)s.hasAttribute("data-src")?await i(s):d(s)})()};return{init:()=>(r=new Map,f=document.querySelectorAll("img"),f.forEach(N.add),p=Array.from(f).some(s=>s.hasAttribute("data-src")),{load:k,setTtl:I,hasDataSrc:g})}})();var X=(()=>{let r=null,f=null,p=null,m=null,h=!1,i=1e3*60*60*6,d="audio",g="audio/mpeg",I="x-expiration-time",k='<i class="fa-solid fa-circle-pause spin-button"></i>',S='<i class="fa-solid fa-circle-play"></i>',s=async()=>{if(navigator.onLine){r.disabled=!0;try{await m,await f.play(),h=!0,r.disabled=!1,r.innerHTML=k}catch(y){h=!1,alert(y)}}},c=()=>{h=!1,f.pause(),r.innerHTML=S},T=(y,L=3,C=1e3)=>D(j,p).default().then(a=>a.blob()).then(a=>{let n=new Headers;return n.set("Content-Type",g),n.set("Content-Length",String(a.size)),n.set(I,String(Date.now()+i)),y.put(p,new Response(a,{headers:n})).then(()=>a)}).catch(a=>{if(L<=0)throw a;return console.warn("Retrying fetch:"+p),new Promise(n=>E.timeOut(()=>n(T(y,L-1,C+1e3)),C))}),u=()=>caches.open(d).then(y=>y.match(p).then(L=>L?Date.now()<=parseInt(L.headers.get(I))?L.blob():y.delete(p).then(C=>C?T(y):L.blob()):T(y))).then(y=>URL.createObjectURL(y));return{init:async()=>{r=document.getElementById("button-music"),p=r.getAttribute("data-url"),document.addEventListener("undangan.open",()=>{r.style.display="block"}),f=new Audio(await u()),f.volume=1,f.loop=!0,f.muted=!1,f.currentTime=0,f.autoplay=!1,f.controls=!1,m=new Promise(y=>f.addEventListener("canplay",y,{once:!0})),r.addEventListener("offline",c),r.addEventListener("click",()=>h?c():s())},play:s,setTtl:y=>i=Number(y)}})();var se={tab:p=>window.bootstrap.Tab.getOrCreateInstance(document.getElementById(p)),modal:p=>window.bootstrap.Modal.getOrCreateInstance(document.getElementById(p))};var R=r=>{let f=(d=null)=>{let g=JSON.parse(localStorage.getItem(r));return d?g[String(d)]:g},p=(d,g)=>{let I=f();I[String(d)]=g,localStorage.setItem(r,JSON.stringify(I))},m=d=>Object.keys(f()).includes(String(d)),h=d=>{if(!m(d))return;let g=f();delete g[String(d)],localStorage.setItem(r,JSON.stringify(g))},i=()=>localStorage.setItem(r,"{}");return localStorage.getItem(r)||i(),{set:p,get:f,has:m,clear:i,unset:h}};var K=(()=>{let r={"#000000":"#ffffff","#ffffff":"#000000","#212529":"#f8f9fa","#f8f9fa":"#212529"},f=["#ffffff","#f8f9fa"],p=["#000000","#212529"],m=!1,h=null,i=null,d=()=>h.set("active","light"),g=()=>h.set("active","dark"),I=$=>{let y=i.getAttribute("content");i.setAttribute("content",$.some(L=>L===y)?r[y]:y)},k=()=>{d(),document.documentElement.setAttribute("data-bs-theme","light"),I(p)},S=()=>{g(),document.documentElement.setAttribute("data-bs-theme","dark"),I(f)},s=($=null,y=null)=>{let L=h.get("active")==="dark";return $&&y?L?$:y:L};return{init:()=>{switch(h=R("theme"),i=document.querySelector('meta[name="theme-color"]'),h.has("active")||(window.matchMedia("(prefers-color-scheme: dark)").matches?g():d()),document.documentElement.getAttribute("data-bs-theme")){case"dark":g();break;case"light":d();break;default:m=!0}s()?S():k()},spyTop:()=>{let $=L=>L.filter(C=>C.isIntersecting).forEach(C=>{let a=C.target.classList.contains("bg-white-black")?s(p[0],f[0]):s(p[1],f[1]);i.setAttribute("content",a)}),y=new IntersectionObserver($,{rootMargin:"0% 0% -95% 0%"});document.querySelectorAll("section").forEach(L=>y.observe(L))},change:()=>s()?k():S(),isDarkMode:s,isAutoMode:()=>m}})();var q=(()=>{let r=null,f=()=>r.get("token"),p=k=>r.set("token",k),m=k=>D(J,"/api/session").body(k).send(U.tokenResponse).then(S=>(S.code===W&&p(S.data.token),S.code===W),()=>!1),h=()=>r.unset("token"),i=()=>String(f()??".").split(".").length===3;return{init:()=>{r=R("session")},guest:()=>D(j,"/api/config").token(f()).send().then(k=>{if(k.code!==W)throw new Error("failed to get config.");let S=R("config");for(let[s,c]of Object.entries(k.data))S.set(s,c);return k}),login:m,logout:h,decode:()=>{if(!i())return null;try{return JSON.parse(window.atob(f().split(".")[1]))}catch{return null}},isAdmin:i,setToken:p,getToken:f}})();var ae=(()=>{let r=null,f=!0,p=()=>f,m=()=>{let s=r.firstElementChild.firstElementChild;s.classList.remove("bg-success"),s.classList.add("bg-danger"),s.firstElementChild.innerHTML='<i class="fa-solid fa-ban me-2"></i>Koneksi tidak tersedia'},h=()=>{let s=r.firstElementChild.firstElementChild;s.classList.remove("bg-danger"),s.classList.add("bg-success"),s.firstElementChild.innerHTML='<i class="fa-solid fa-cloud me-2"></i>Koneksi tersedia kembali'},i=async()=>{await E.changeOpacity(r,!1),m()},d=()=>{let s=null;s=setTimeout(()=>{clearTimeout(s),s=null,f&&i()},3e3)},g=()=>{let s=["input[data-offline-disabled]","button[data-offline-disabled]","select[data-offline-disabled]","textarea[data-offline-disabled]"].join(", ");document.querySelectorAll(s).forEach(c=>{c.dispatchEvent(new Event(p()?"online":"offline")),c.setAttribute("data-offline-disabled",p()?"false":"true"),c.tagName==="BUTTON"?p()?c.classList.remove("disabled"):c.classList.add("disabled"):p()?c.removeAttribute("disabled"):c.setAttribute("disabled","true")})},I=()=>{f=!1,m(),E.changeOpacity(r,!0),g()},k=()=>{f=!0,h(),d(),g()};return{init:()=>{window.addEventListener("online",k),window.addEventListener("offline",I),r=document.getElementById("offline-mode"),r.innerHTML=`
        <div class="d-flex justify-content-center mx-auto">
            <div class="d-flex justify-content-center align-items-center rounded-pill my-2 bg-danger shadow">
                <small class="text-center py-1 px-2 mx-1 mt-1 mb-0 text-white" style="font-size: 0.8rem;"></small>
            </div>
        </div>`},isOnline:p}})();var _=(()=>{let r="gifs",f="default",p={128:2,256:3,512:4,768:5},m={id:"ID",en:"US",fr:"FR",de:"DE",es:"ES",zh:"CN",ja:"JP",ko:"KR",ar:"SA",ru:"RU",it:"IT",nl:"NL",pt:"PT",tr:"TR",th:"TH",vi:"VN",ms:"MY",hi:"IN"},h=null,i=null,d=null,g=null,I=async t=>{if(h.has(t))return h.get(t);let l=(v,B=3,P=1e3)=>D(j,t).default().then(O=>O.blob().then(V=>v.put(t,new Response(V,{headers:new Headers(O.headers)})).then(()=>V))).catch(O=>{if(B<=0)throw O;return console.warn("Retrying fetch:"+t),new Promise(V=>E.timeOut(()=>V(l(v,B-1,P+1e3)),P))}),H=v=>v.match(t).then(B=>{if(!B)return l(v);let P=B.headers.get("expires"),O=P?new Date(P).getTime():0;return Date.now()>O?v.delete(t).then(V=>V?l(v):B.blob()):B.blob()});return await caches.open(r).then(v=>H(v)).then(v=>URL.createObjectURL(v)).then(v=>(h.set(t,v),v))},k=async(t,l)=>{let{id:H,media_formats:{tinygif:{url:A}},content_description:v}=l;t.pointer===-1||t.pointer===t.col-1?t.pointer=0:t.pointer++;let B=0;for(let P of t.lists.childNodes)B===t.pointer&&await I(A).then(O=>{P.insertAdjacentHTML("beforeend",`
                    <figure class="gif-figure m-0 position-relative">
                        <div onclick="undangan.comment.gif.click('${t.uuid}', '${H}', '${E.base64Encode(A)}')" class="gif-checklist position-absolute justify-content-center align-items-center top-0 end-0 bg-overlay-auto p-1 m-1 rounded-circle border shadow-sm z-1">
                            <i class="fa-solid fa-circle-check"></i>
                        </div>
                        <img src="${O}" class="img-fluid" alt="${E.escapeHtml(v)}" style="width: 100%;">
                    </figure>
                `)}),B++},S=t=>{let l=t.lists,H=document.getElementById(`gif-loading-${t.uuid}`);return l.classList.contains("d-none")||H.classList.replace("d-none","d-flex"),l.setAttribute("data-continue","false"),l.classList.replace("overflow-y-scroll","overflow-y-hidden"),{release:()=>{l.classList.contains("d-none")||H.classList.replace("d-flex","d-none"),l.setAttribute("data-continue","true"),l.classList.replace("overflow-y-hidden","overflow-y-scroll")}}},s=(t,l,H)=>{let A=!0;t.last=new Promise(v=>{let B=S(t);(async()=>(await l,A=!1))(),(async()=>{try{let P=await H;t.next=P?.next;for(let O of P.results)A&&(t.gifs.push(O),await k(t,O))}catch(P){P.name==="AbortError"?console.warn("Fetch abort:",P):alert(P)}finally{B.release(),v()}})()})},c=(t,l)=>{l={key:g.get("tenor_key"),media_filter:"tinygif",client_key:"undangan_app",country:g.get("country"),locale:g.get("locale"),...l??{}};let H=Object.keys(l).filter(v=>l[v]!==null&&l[v]!==void 0).filter(v=>typeof l[v]!="object").map(v=>`${v}=${encodeURIComponent(l[v])}`).join("&"),A=D(j,`https://tenor.googleapis.com/v2${t}?${H}`);return l.reqCancel&&(A=A.withCancel(l.reqCancel)),A.default().then(v=>v.json()).then(v=>{if(!v.error)return v;throw new Error(v.error.message)})},T=async t=>{if(!t.next||t.next.length===0)return;let l=t.query&&t.query.trim().length,H={pos:t.next,limit:t.limit};l&&(H.q=t.query),t.last&&(await t.last,t.last=null),H.reqCancel=new Promise(v=>{t.reqs.push(v)});let A=(t.lists.scrollHeight-t.lists.clientHeight)*.9;t.lists.scrollTop>A&&t.lists.getAttribute("data-continue")==="true"&&s(t,H.reqCancel,c(l?"/search":"/featured",H))},u=t=>`
        <label for="gif-search-${t}" class="form-label my-1"><i class="fa-solid fa-photo-film me-2"></i>Gif</label>

        <div class="d-flex mb-3" id="gif-search-nav-${t}">
            <button class="btn btn-secondary btn-sm rounded-4 shadow-sm me-1 my-1" onclick="undangan.comment.gif.back('${t}')" data-offline-disabled="false"><i class="fa-solid fa-arrow-left"></i></button>
            <input type="text" name="gif-search" id="gif-search-${t}" autocomplete="off" class="form-control shadow-sm rounded-4" placeholder="Cari GIF oleh Tenor" data-offline-disabled="false">
        </div>

        <div class="position-relative">
            <div class="position-absolute d-flex justify-content-center align-items-center top-50 start-50 translate-middle w-100 h-100 bg-overlay-auto rounded-4 z-3" id="gif-loading-${t}">
                <div class="spinner-border" role="status"></div>
            </div>
            <div id="gif-lists-${t}" class="d-flex rounded-4 p-0 overflow-y-scroll border" data-continue="true" style="height: 15rem;"></div>
        </div>

        <figure class="d-flex m-0 position-relative" id="gif-result-${t}">
            <div onclick="undangan.comment.gif.cancel('${t}')" id="gif-cancel-${t}" class="d-none position-absolute justify-content-center align-items-center top-0 end-0 bg-overlay-auto p-2 m-1 rounded-circle border shadow-sm z-1" style="cursor: pointer;">
                <i class="fa-solid fa-circle-xmark"></i>
            </div>
        </figure>`,w=async t=>{let l=0;for(let[A,v]of Object.entries(p))l=v,t.lists.clientWidth>=parseInt(A)&&(t.col=l);if(t.col===null&&(t.col=l),t.pointer=-1,t.limit=t.col*5,t.lists.innerHTML='<div class="d-flex flex-column"></div>'.repeat(t.col),t.gifs.length===0)return;let H=S(t);for(let A of t.gifs)await k(t,A);H.release()},$=async(t,l)=>{t.query=l.value,(!t.query||t.query.trim().length===0)&&(t.query=null),t.reqs.forEach(A=>A()),t.reqs=[],t.last&&(await t.last,t.last=null);let H=new Promise(A=>{t.reqs.push(A)});t.next=null,t.gifs=[],t.pointer=-1,await w(t),s(t,H,c(t.query===null?"/featured":"/search",{q:t.query,limit:t.limit,reqCancel:H}))},y=t=>{if(!i.has(t)){let l=document.getElementById(`gif-form-${t}`);l.innerHTML=u(t);let H=E.debounce(w,500),A=E.debounce($,500);i.set(t,{uuid:t,last:null,limit:null,query:null,next:null,col:null,pointer:-1,gifs:[],reqs:[],container:l,lists:document.getElementById(`gif-lists-${t}`),result:document.getElementById(`gif-result-${t}`)});let v=i.get(t);v.lists.addEventListener("scroll",()=>T(v)),window.addEventListener("resize",()=>H(v)),document.getElementById(`gif-search-${t}`).addEventListener("input",B=>A(v,B.target))}return i.get(t)};return{default:f,init:()=>{h=new Map,d=new Map,i=new Map,g=R("config");let t=document.documentElement.lang.toLowerCase();g.set("country",m[t]??"US"),g.set("locale",`${t}_${g.get("country")}`),g.get("tenor_key")===null&&document.querySelector('[onclick="undangan.comment.gif.open(undangan.comment.gif.default)"]')?.remove()},cache:I,back:t=>{y(t).container.classList.toggle("d-none",!0),document.getElementById(`comment-form-${t}`)?.classList.toggle("d-none",!1)},open:async t=>{let l=y(t);l.container.classList.toggle("d-none",!1),document.getElementById(`comment-form-${t}`)?.classList.toggle("d-none",!0),d.has(t)&&d.get(t)(),l.reqs.forEach(A=>A()),l.reqs=[],l.last&&(await l.last,l.last=null);let H=new Promise(A=>{l.reqs.push(A)});await w(l),s(l,H,c("/featured",{limit:l.limit,reqCancel:H}))},cancel:t=>{let l=y(t);l.result.removeAttribute("data-id"),l.result.querySelector(`#gif-cancel-${t}`).classList.replace("d-flex","d-none"),l.result.querySelector("img").remove(),l.lists.classList.replace("d-none","d-flex"),document.getElementById(`gif-search-nav-${t}`).classList.replace("d-none","d-flex")},click:(t,l,H)=>{let A=y(t);A.result.setAttribute("data-id",l),A.result.querySelector(`#gif-cancel-${t}`).classList.replace("d-none","d-flex"),A.result.insertAdjacentHTML("beforeend",`<img src="${h.get(E.base64Decode(H))}" class="img-fluid mx-auto gif-image rounded-4" alt="selected-gif">`),A.lists.classList.replace("d-flex","d-none"),document.getElementById(`gif-search-nav-${t}`).classList.replace("d-flex","d-none"),c("/registershare",{id:l,q:A.query})},remove:(t=null)=>{t?i.has(t)&&(i.get(t).reqs.forEach(l=>l()),i.delete(t),d.delete(t)):(i.forEach(l=>l.reqs.forEach(H=>H())),i.clear(),d.clear())},isOpen:t=>{if(!i.has(t))return!1;let l=i.get(t);return l.container===null?!1:!l.container.classList.contains("d-none")},onOpen:(t,l)=>d.set(t,l),getResultId:t=>i.get(t)?.result?.getAttribute("data-id"),getAttribute:(t,l)=>{try{return i.get(t)[l]}catch{return null}}}})();var F=(()=>{let r=null,f=null,p=null,m=null,h=null,i=null,d=250,g=[["*",'<strong class="text-theme-auto">$1</strong>'],["_",'<em class="text-theme-auto">$1</em>'],["~",'<del class="text-theme-auto">$1</del>'],["```",'<code class="font-monospace text-theme-auto">$1</code>']],I=()=>`
        <div class="bg-theme-auto shadow p-3 mx-0 mt-0 mb-3 rounded-4">
            <div class="d-flex justify-content-between align-items-center placeholder-wave">
                <span class="placeholder bg-secondary col-5 rounded-3 my-1"></span>
                <span class="placeholder bg-secondary col-3 rounded-3 my-1"></span>
            </div>
            <hr class="my-1">
            <p class="placeholder-wave m-0">
                <span class="placeholder bg-secondary col-6 rounded-3"></span>
                <span class="placeholder bg-secondary col-5 rounded-3"></span>
                <span class="placeholder bg-secondary col-12 rounded-3 my-1"></span>
            </p>
        </div>`,k=e=>(g.forEach(o=>{let b=o[0],x=o[1];e=e.replace(new RegExp(`\\${b}(?=\\S)(.*?)(?<!\\s)\\${b}`,"gs"),x)}),e),S=e=>`
        <button style="font-size: 0.8rem;" onclick="undangan.comment.like.love(this)" data-uuid="${e.uuid}" class="btn btn-sm btn-outline-auto ms-auto rounded-3 p-0 shadow-sm d-flex justify-content-start align-items-center" data-offline-disabled="false">
            <span class="my-0 mx-1" data-count-like="${e.like.love}">${e.like.love}</span>
            <i class="me-1 ${p.has(e.uuid)?"fa-solid fa-heart text-danger":"fa-regular fa-heart"}"></i>
        </button>`,s=e=>{let o=e.gif_url!==null&&e.gif_url!==void 0,b=`<div class="d-flex justify-content-start align-items-center" data-button-action="${e.uuid}">`;return(m.get("can_reply")===!0||m.get("can_reply")===void 0)&&(b+=`<button style="font-size: 0.8rem;" onclick="undangan.comment.reply(this)" data-uuid="${e.uuid}" class="btn btn-sm btn-outline-auto rounded-4 py-0 me-1 shadow-sm" data-offline-disabled="false">Reply</button>`),f.has(e.uuid)&&(m.get("can_edit")===!0||m.get("can_edit")===void 0)&&!(o&&m.get("tenor_key")===null)&&(b+=`<button style="font-size: 0.8rem;" onclick="undangan.comment.edit(this)" data-uuid="${e.uuid}" class="btn btn-sm btn-outline-auto rounded-4 py-0 me-1 shadow-sm" data-offline-disabled="false">Edit</button>`),q.isAdmin()?b+=`<button style="font-size: 0.8rem;" onclick="undangan.comment.remove(this)" data-uuid="${e.uuid}" class="btn btn-sm btn-outline-auto rounded-4 py-0 me-1 shadow-sm" data-own="${e.own}" data-offline-disabled="false">Delete</button>`:f.has(e.uuid)&&(m.get("can_delete")===!0||m.get("can_delete")===void 0)&&(b+=`<button style="font-size: 0.8rem;" onclick="undangan.comment.remove(this)" data-uuid="${e.uuid}" class="btn btn-sm btn-outline-auto rounded-4 py-0 me-1 shadow-sm" data-offline-disabled="false">Delete</button>`),b+="</div>",b},c=(e,o)=>{let b=i.get("show").includes(e);return`<a class="text-theme-auto" style="font-size: 0.8rem;" onclick="undangan.comment.showOrHide(this)" data-uuid="${e}" data-uuids="${o.join(",")}" data-show="${b?"true":"false"}" role="button" class="me-auto ms-1 py-0">${b?"Hide replies":`Show replies (${o.length})`}</a>`},T=e=>`
        <div class="d-flex justify-content-between align-items-center" id="button-${e.uuid}">
            ${s(e)}
            ${e.comments.length>0?c(e.uuid,e.comments.map(o=>o.uuid)):""}
            ${S(e)}
        </div>`,u=e=>e.ip===void 0||e.user_agent===void 0||e.is_admin?"":`
        <div class="mb-1 mt-3">
            <p class="text-theme-auto mb-1 mx-0 mt-0 p-0" style="font-size: 0.7rem;" id="ip-${e.uuid}"><i class="fa-solid fa-location-dot me-1"></i>${E.escapeHtml(e.ip)} ${h.has(e.ip)?`<strong>${h.get(e.ip)}</strong>`:'<span class="mb-1 placeholder col-2 rounded-3"></span>'}</p>
            <p class="text-theme-auto m-0 p-0" style="font-size: 0.7rem;"><i class="fa-solid fa-mobile-screen-button me-1"></i>${E.parseUserAgent(E.escapeHtml(e.user_agent))}</p>
        </div>`,w=(e,o)=>o?'class="bg-theme-auto shadow p-3 mx-0 mt-0 mb-3 rounded-4" data-parent="true"':`class="${i.get("hidden").find(b=>b.uuid===e.uuid).show?"":"d-none"} overflow-x-scroll mw-100 border-start bg-theme-auto py-2 ps-2 pe-0 my-2 ms-2 me-0"`,$=(e,o)=>e.is_admin?`<strong class="me-1">${E.escapeHtml(r.get("name")??m.get("name"))}</strong><i class="fa-solid fa-certificate text-primary"></i>`:o?`<strong class="me-1">${E.escapeHtml(e.name)}</strong><i id="badge-${e.uuid}" class="fa-solid ${e.presence?"fa-circle-check text-success":"fa-circle-xmark text-danger"}"></i>`:`<strong>${E.escapeHtml(e.name)}</strong>`,y=async(e,o)=>{let b=k(E.escapeHtml(e.comment)),x=b.length>d,M=e.gif_url!==null&&e.gif_url!==void 0,z=`
        <div class="d-flex justify-content-between align-items-center">
            <p class="text-theme-auto text-truncate m-0 p-0" style="font-size: 0.95rem;">${$(e,o)}</p>
            <small class="text-theme-auto m-0 p-0" style="font-size: 0.75rem;">${e.created_at}</small>
        </div>
        <hr class="my-1">
        `;if(M){let t=await _.cache(e.gif_url);return z+`
            <div class="d-flex justify-content-center align-items-center my-2">
                <img src="${t}" id="img-gif-${e.uuid}" class="img-fluid mx-auto gif-image rounded-4" alt="selected-gif">
            </div>
            `}return z+`
        <p class="text-theme-auto my-1 mx-0 p-0" style="white-space: pre-wrap !important; font-size: 0.95rem;" ${x?`data-comment="${E.base64Encode(b)}"`:""} id="content-${e.uuid}">${x?b.slice(0,d)+"...":b}</p>
        ${x?`<p class="d-block mb-2 mt-0 mx-0 p-0"><a class="text-theme-auto" role="button" style="font-size: 0.85rem; display: block;" data-show="false" onclick="undangan.comment.showMore(this, '${e.uuid}')">Selengkapnya</a></p>`:""}`},L=async(e,o)=>{let b=await y(e,o),x="";for(let M of e.comments)x+=await L(M,!1);return`
        <div ${w(e,o)} id="${e.uuid}" style="overflow-wrap: break-word !important;">
            <div id="body-content-${e.uuid}" data-tapTime="0" data-liked="false" tabindex="0">
                ${b}
            </div>
            ${u(e)}
            ${T(e)}
            <div id="reply-content-${e.uuid}">${x}</div>
        </div>`};return{init:()=>{r=R("user"),f=R("owns"),p=R("likes"),m=R("config"),h=R("tracker"),i=R("comment")},renderEdit:(e,o,b,x)=>{let M=document.createElement("div");return M.classList.add("my-2"),M.id=`inner-${e}`,M.innerHTML=`
        <p class="my-1 mx-0 p-0" style="font-size: 0.95rem;"><i class="fa-solid fa-pen me-2"></i>Edit</p>
        ${b?`
        <select class="form-select shadow-sm mb-2 rounded-4" id="form-inner-presence-${e}" data-offline-disabled="false">
            <option value="1" ${o?"selected":""}>Datang</option>
            <option value="2" ${o?"":"selected"}>Berhalangan</option>
        </select>`:""}
        ${x?`${m.get("tenor_key")===null?"":`<div class="d-none mb-2" id="gif-form-${e}"></div>`}`:`<textarea class="form-control shadow-sm rounded-4 mb-2" id="form-inner-${e}" minlength="1" maxlength="1000" placeholder="Type update comment" rows="3" data-offline-disabled="false"></textarea>    
        `}
        <div class="d-flex justify-content-end align-items-center mb-0">
            <button style="font-size: 0.8rem;" onclick="undangan.comment.cancel('${e}')" class="btn btn-sm btn-outline-auto rounded-4 py-0 me-1" data-offline-disabled="false">Cancel</button>
            <button style="font-size: 0.8rem;" onclick="undangan.comment.update(this)" data-uuid="${e}" class="btn btn-sm btn-outline-auto rounded-4 py-0" data-offline-disabled="false">Update</button>
        </div>`,M},renderReply:e=>{let o=document.createElement("div");return o.classList.add("my-2"),o.id=`inner-${e}`,o.innerHTML=`
        <p class="my-1 mx-0 p-0" style="font-size: 0.95rem;"><i class="fa-solid fa-reply me-2"></i>Reply</p>
        <div class="d-block mb-2" id="comment-form-${e}">
            <div class="position-relative">
                ${m.get("tenor_key")===null?"":`<button class="btn btn-secondary btn-sm rounded-4 shadow-sm me-1 my-1 position-absolute bottom-0 end-0" onclick="undangan.comment.gif.open('${e}')" aria-label="button gif" data-offline-disabled="false"><i class="fa-solid fa-photo-film"></i></button>`}
                <textarea class="form-control shadow-sm rounded-4 mb-2" id="form-inner-${e}" minlength="1" maxlength="1000" placeholder="Type reply comment" rows="3" data-offline-disabled="false"></textarea>
            </div>
        </div>
        <div class="d-none mb-2" id="gif-form-${e}"></div>
        <div class="d-flex justify-content-end align-items-center mb-0">
            <button style="font-size: 0.8rem;" onclick="undangan.comment.cancel('${e}')" class="btn btn-sm btn-outline-auto rounded-4 py-0 me-1" data-offline-disabled="false">Cancel</button>
            <button style="font-size: 0.8rem;" onclick="undangan.comment.send(this)" data-uuid="${e}" class="btn btn-sm btn-outline-auto rounded-4 py-0" data-offline-disabled="false">Send</button>
        </div>`,o},renderLoading:I,renderReadMore:c,renderInnerContent:e=>L(e,!1),renderContent:e=>L(e,!0),convertMarkdownToHTML:k,maxCommentLength:d}})();var ie=()=>window.confetti.shapeFromPath({path:"M167 72c19,-38 37,-56 75,-56 42,0 76,33 76,75 0,76 -76,151 -151,227 -76,-76 -151,-151 -151,-227 0,-42 33,-75 75,-75 38,0 57,18 76,56z",matrix:[.03333333333333333,0,0,.03333333333333333,-5.566666666666666,-5.533333333333333]}),re=()=>{window.confetti({origin:{y:1},zIndex:1057})},le=(r=15)=>{let f=r*1e3,p=Date.now()+f,m=ie(),h=["#FFC0CB","#FF1493","#C71585"],i=(d,g)=>Math.random()*(g-d)+d;(function d(){let g=p-Date.now();h.forEach(I=>{window.confetti({particleCount:1,startVelocity:0,ticks:Math.max(50,75*(g/f)),origin:{x:Math.random(),y:Math.abs(Math.random()-g/f)},zIndex:1057,colors:[I],shapes:[m],drift:i(-.5,.5),gravity:i(.5,1),scalar:i(.5,1)})}),g>0&&requestAnimationFrame(d)})()},ce=r=>{if(!window.confetti)return;let f=Date.now()+25,p=Math.max(.3,Math.min(1,r.getBoundingClientRect().top/window.innerHeight+.2)),m=ie(),h=["#FF69B4","#FF1493"];(function i(){h.forEach(d=>{window.confetti({particleCount:2,angle:60,spread:55,shapes:[m],origin:{x:0,y:p},zIndex:1057,colors:[d]}),window.confetti({particleCount:2,angle:120,spread:55,shapes:[m],origin:{x:1,y:p},zIndex:1057,colors:[d]})}),Date.now()<f&&requestAnimationFrame(i)})()};var Y=(()=>{let r=null,f=async h=>{let i=h.firstElementChild,d=h.lastElementChild,g=h.getAttribute("data-uuid"),I=parseInt(i.getAttribute("data-count-like"));h.disabled=!0,r.has(g)?await D(ne,"/api/comment/"+r.get(g)).token(q.getToken()).send(U.statusResponse).then(k=>{k.data.status&&(r.unset(g),d.classList.remove("fa-solid","text-danger"),d.classList.add("fa-regular"),i.setAttribute("data-count-like",String(I-1)))}):await D(J,"/api/comment/"+g).token(q.getToken()).send(U.uuidResponse).then(k=>{k.code===Q&&(r.set(g,k.data.uuid),d.classList.remove("fa-regular"),d.classList.add("fa-solid","text-danger"),i.setAttribute("data-count-like",String(I+1)))}),i.innerText=i.getAttribute("data-count-like"),h.disabled=!1};return{init:()=>{r=R("likes")},love:f,tapTap:async h=>{if(!navigator.onLine)return;let i=Date.now(),d=i-parseInt(h.getAttribute("data-tapTime")),g=h.id.replace("body-content-",""),I=d<300&&d>0,k=!r.has(g)&&h.getAttribute("data-liked")!=="true";if(I&&k){navigator.vibrate&&navigator.vibrate(100),ce(h);let S=document.querySelector(`[onclick="undangan.comment.like.love(this)"][data-uuid="${g}"]`);h.setAttribute("data-liked","true"),await f(S),h.setAttribute("data-liked","false")}h.setAttribute("data-tapTime",i)}}})();var G=(()=>{let r=10,f=0,p=0,m=null,h=null,i=null,d=null,g=null,I=o=>{r=Number(o)},k=()=>r,S=()=>f,s=()=>p,c=()=>h.classList.contains("disabled")?null:h.classList.add("disabled"),T=()=>h.classList.contains("disabled")?h.classList.remove("disabled"):null,u=()=>i.classList.contains("disabled")?null:i.classList.add("disabled"),w=()=>i.classList.contains("disabled")?i.classList.remove("disabled"):null,$=()=>{d.classList.contains("d-none")&&d.classList.remove("d-none")},y=o=>{o.disabled=!0;let b=o.innerHTML;o.innerHTML=E.loader.replace("ms-0 me-1","mx-1");let x=async()=>{let t=new Promise(l=>g.addEventListener("comment.result",l));g.dispatchEvent(new Event("comment.show")),await t,o.disabled=!1,o.innerHTML=b,g.scrollIntoView({behavior:"smooth"})};return{next:async()=>{f+=r,o.innerHTML="Next"+o.innerHTML,await x(),m.innerText=String(parseInt(m.innerText)+1)},prev:async()=>{f-=r,o.innerHTML=o.innerHTML+"Prev",await x(),m.innerText=String(parseInt(m.innerText)-1)}}};return{init:()=>{d=document.getElementById("pagination"),d.innerHTML=`
        <ul class="pagination mb-2 shadow-sm rounded-4">
            <li class="page-item disabled" id="previous">
                <button class="page-link rounded-start-4" onclick="undangan.comment.pagination.previous(this)" data-offline-disabled="false">
                    <i class="fa-solid fa-circle-left me-1"></i>Prev
                </button>
            </li>
            <li class="page-item disabled">
                <span class="page-link text-theme-auto" id="page">1</span>
            </li>
            <li class="page-item" id="next">
                <button class="page-link rounded-end-4" onclick="undangan.comment.pagination.next(this)" data-offline-disabled="false">
                    Next<i class="fa-solid fa-circle-right ms-1"></i>
                </button>
            </li>
        </ul>`,g=document.getElementById("comments"),m=document.getElementById("page"),h=document.getElementById("previous"),i=document.getElementById("next")},setPer:I,getPer:k,getNext:S,reset:()=>f===0?!1:(f=0,p=0,m.innerText=1,u(),c(),!0),setResultData:o=>{if(p=o,f>0&&T(),p<r){u();return}w(),$()},getResultData:s,previous:async o=>{c(),!(f<0)&&(u(),await y(o).prev())},next:async o=>{u(),!(p<r)&&(c(),await y(o).next())}}})();var Z=(()=>{let r=null,f=null,p=null,m=null,h=[],i=()=>'<div class="text-center p-4 my-2 bg-theme-auto rounded-4 shadow"><p class="fw-bold p-0 m-0" style="font-size: 0.95rem;">Yuk bagikan undangan ini biar banyak komentarnya</p></div>',d=(a,n)=>{document.querySelector(`[data-button-action="${a}"]`).childNodes.forEach(e=>{e.disabled=n})},g=a=>{a.comments&&a.comments.forEach(g);let n=document.getElementById(`body-content-${a.uuid}`);n.addEventListener("touchend",()=>Y.tapTap(n))},I=a=>{if(!q.isAdmin()||(a.comments&&a.comments.forEach(I),a.ip===void 0||a.user_agent===void 0||a.is_admin||p.has(a.ip)))return;let n=(e,o,b)=>{document.getElementById(`ip-${e}`).innerHTML=`<i class="fa-solid fa-location-dot me-1"></i>${E.escapeHtml(o)} <strong>${E.escapeHtml(b)}</strong>`};D(j,`https://freeipapi.com/api/json/${a.ip}`).default().then(e=>e.json()).then(e=>{let o=e.cityName+" - "+e.regionName;e.cityName==="-"&&e.regionName==="-"&&(o="localhost"),p.set(a.ip,o),n(a.uuid,a.ip,o)}).catch(e=>n(a.uuid,a.ip,e.message))},k=(a,n=[])=>(a.forEach(e=>{n.find(o=>o.uuid===e.uuid)||n.push(U.commentShowMore(e.uuid)),e.comments&&e.comments.length>0&&k(e.comments,n)}),n),S=()=>{let a=document.getElementById("comments");return a.getAttribute("data-loading")==="false"&&(a.setAttribute("data-loading","true"),a.innerHTML=F.renderLoading().repeat(G.getPer())),D(j,`/api/comment?per=${G.getPer()}&next=${G.getNext()}`).token(q.getToken()).send(U.getCommentsResponse).then(async n=>{let e=n.data.length;if(a.setAttribute("data-loading","false"),h.map(b=>b.uuid).forEach(b=>_.remove(b)),e===0)return G.setResultData(e),a.innerHTML=i(),n;h=k(n.data),m.set("hidden",k(n.data,m.get("hidden")));let o="";for(let b of n.data)o+=await F.renderContent(b);return a.innerHTML=o,n.data.forEach(I),n.data.forEach(g),G.setResultData(e),a.dispatchEvent(new Event("comment.result")),n})},s=a=>{let n=a.getAttribute("data-uuids").split(","),e=a.getAttribute("data-show")==="true",o=a.getAttribute("data-uuid");e?(a.setAttribute("data-show","false"),a.innerText=`Show replies (${n.length})`,m.set("show",m.get("show").filter(b=>b!==o))):(a.setAttribute("data-show","true"),a.innerText="Hide replies",m.set("show",m.get("show").concat([o])));for(let b of n){m.set("hidden",m.get("hidden").map(M=>(M.uuid===b&&(M.show=!e),M)));let x=document.getElementById(b).classList;e?x.add("d-none"):x.remove("d-none")}};return{gif:_,like:Y,pagination:G,init:()=>{_.init(),Y.init(),F.init(),G.init(),document.getElementById("comments").addEventListener("comment.show",S),r=R("owns"),f=R("user"),p=R("tracker"),m=R("comment"),m.has("hidden")||m.set("hidden",[]),m.has("show")||m.set("show",[])},send:async a=>{let n=a.getAttribute("data-uuid"),e=document.getElementById("form-name"),o=e.value;if(q.isAdmin()&&(o=f.get("name")),o.length===0){alert("Name cannot be empty."),n&&document.getElementById("comment").scrollIntoView({behavior:"smooth"});return}let b=document.getElementById("form-presence");if(!n&&b&&b.value==="0"){alert("Please select your attendance status.");return}let x=_.isOpen(n||"default"),M=_.getResultId(n||"default"),z=document.getElementById(`gif-cancel-${n||"default"}`);if(x&&!M){alert("Gif cannot be empty.");return}x&&M&&z.classList.replace("d-flex","d-none");let t=document.getElementById(`form-${n?`inner-${n}`:"comment"}`);if(!x&&t.value.length===0){alert("Comments cannot be empty.");return}!n&&e&&!q.isAdmin()&&(e.disabled=!0),!q.isAdmin()&&b&&b.value!=="0"&&(b.disabled=!0),t&&(t.disabled=!0);let l=document.querySelector(`[onclick="undangan.comment.cancel('${n}')"]`);l&&(l.disabled=!0);let H=E.disableButton(a),A=b?b.value==="1":!0;if(!q.isAdmin()){let B=R("information");B.set("name",o),n||B.set("presence",A)}let v=await D(J,"/api/comment").token(q.getToken()).body(U.postCommentRequest(n,o,A,_.isOpen(n)?null:t.value,M)).send(U.getCommentResponse).then(B=>B,()=>null);if(e&&(e.disabled=!1),t&&(t.disabled=!1),l&&(l.disabled=!1),b&&(b.disabled=!1),x&&M&&z.classList.replace("d-none","d-flex"),H.restore(),!(!v||v.code!==Q)){if(r.set(v.data.uuid,v.data.own),t&&(t.value=null),x&&M&&z.dispatchEvent(new Event("click")),!n){let B=document.getElementById("comments");if(await G.reset()){await S(),B.scrollIntoView({behavior:"smooth"});return}G.setResultData(B.children.length),G.getResultData()===G.getPer()&&B.lastElementChild.remove(),v.data.is_admin=q.isAdmin();let O=await F.renderContent(v.data);B.insertAdjacentHTML("afterbegin",O),B.scrollIntoView({behavior:"smooth"})}if(n){m.set("hidden",m.get("hidden").concat([U.commentShowMore(v.data.uuid,!0)])),m.set("show",m.get("show").concat([n])),d(n,!1),document.getElementById(`inner-${n}`).remove(),v.data.is_admin=q.isAdmin(),document.getElementById(`reply-content-${n}`).insertAdjacentHTML("beforeend",await F.renderInnerContent(v.data));let B=document.getElementById(`button-${n}`),P=B.querySelector("a"),O=[v.data.uuid];P&&(P.getAttribute("data-show")==="false"&&s(P),P.remove());let V=`button[onclick="undangan.comment.like.love(this)"][data-uuid="${n}"]`;B.querySelector(V).insertAdjacentHTML("beforebegin",F.renderReadMore(n,P?P.getAttribute("data-uuids").split(",").concat(O):O))}g(v.data)}},edit:async a=>{let n=a.getAttribute("data-uuid");if(document.getElementById(`inner-${n}`))return;d(n,!0);let e=E.disableButton(a);await D(j,"/api/comment/"+n).token(q.getToken()).send(U.commentResponse).then(o=>{if(o.code!==W)return o;let b=o.data.gif_url!==null&&o.data.gif_url!==void 0;b&&_.remove(n);let x=document.getElementById(n).getAttribute("data-parent")==="true"&&!q.isAdmin();if(document.getElementById(`button-${n}`).insertAdjacentElement("afterend",F.renderEdit(n,o.data.presence,x,b)),b)return _.onOpen(n,()=>{document.querySelector(`[for="gif-search-${n}"]`)?.remove(),document.querySelector(`[onclick="undangan.comment.gif.back('${n}')"]`)?.remove()}),_.open(n);let M=document.getElementById(`form-inner-${n}`);return M.value=o.data.comment,M.setAttribute("data-original",E.base64Encode(o.data.comment)),o}),e.restore(),a.disabled=!0},reply:a=>{let n=a.getAttribute("data-uuid");document.getElementById(`inner-${n}`)||(_.remove(n),d(n,!0),document.getElementById(`button-${n}`).insertAdjacentElement("afterend",F.renderReply(n)),_.onOpen(n,()=>document.querySelector(`[for="gif-search-${n}"]`)?.remove()))},remove:async a=>{if(!confirm("Are you sure?"))return;let n=a.getAttribute("data-uuid");q.isAdmin()&&r.set(n,a.getAttribute("data-own")),d(n,!0);let e=E.disableButton(a),o=document.querySelector(`[onclick="undangan.comment.like.love(this)"][data-uuid="${n}"]`);if(o.disabled=!0,!await D(oe,"/api/comment/"+r.get(n)).token(q.getToken()).send(U.statusResponse).then(M=>M.data.status,()=>!1)){e.restore(),o.disabled=!1;return}document.querySelectorAll('a[onclick="undangan.comment.showOrHide(this)"]').forEach(M=>{let z=M.getAttribute("data-uuids").split(",");if(z.find(t=>t===n)){let t=z.filter(l=>l!==n).join(",");t.length===0?M.remove():M.setAttribute("data-uuids",t)}}),r.unset(n),document.getElementById(n).remove();let x=document.getElementById("comments");x.children.length===0&&(x.innerHTML=i())},update:async a=>{let n=a.getAttribute("data-uuid"),e=!1,o=document.getElementById(`form-inner-presence-${n}`);o&&(o.disabled=!0,e=o.value==="1");let b=!1,x=document.getElementById(`badge-${n}`);x&&(b=x.classList.contains("text-success"));let M=_.isOpen(n),z=_.getResultId(n),t=document.getElementById(`gif-cancel-${n}`),l=document.getElementById(`form-inner-${n}`);if(M&&z&&t.classList.replace("d-flex","d-none"),n&&!M&&E.base64Encode(l.value)===l.getAttribute("data-original")&&b===e){d(n,!1),document.getElementById(`inner-${n}`).remove();return}l&&(l.disabled=!0);let H=document.querySelector(`[onclick="undangan.comment.cancel('${n}')"]`);H&&(H.disabled=!0);let A=E.disableButton(a),v=await D(te,"/api/comment/"+r.get(n)).token(q.getToken()).body(U.updateCommentRequest(o?e:null,_.isOpen(n)?null:l.value,z)).send(U.statusResponse).then(B=>B.data.status,()=>!1);if(l&&(l.disabled=!1),H&&(H.disabled=!1),o&&(o.disabled=!1),A.restore(),M&&z&&t.classList.replace("d-none","d-flex"),!!v){if(M&&z&&(document.getElementById(`img-gif-${n}`).src=_.getAttribute(n,"result").querySelector("img").src,t.dispatchEvent(new Event("click"))),d(n,!1),document.getElementById(`inner-${n}`).remove(),!M){let B=document.querySelector(`[onclick="undangan.comment.showMore(this, '${n}')"]`),P=F.convertMarkdownToHTML(E.escapeHtml(l.value)),O=document.getElementById(`content-${n}`);P.length>F.maxCommentLength?(O.innerHTML=B?.getAttribute("data-show")==="false"?P.slice(0,F.maxCommentLength)+"...":P,O.setAttribute("data-comment",E.base64Encode(P)),B?.classList.replace("d-none","d-block")):(O.innerHTML=P,O.removeAttribute("data-comment"),B?.classList.replace("d-block","d-none"))}if(o&&(document.getElementById("form-presence").value=e?"1":"2",R("information").set("presence",e)),!(!o||!x)){if(e){x.classList.remove("fa-circle-xmark","text-danger"),x.classList.add("fa-circle-check","text-success");return}x.classList.remove("fa-circle-check","text-success"),x.classList.add("fa-circle-xmark","text-danger")}}},cancel:a=>{let n=document.getElementById(`form-inner-presence-${a}`),e=n?n.value==="1":!1,o=document.getElementById(`badge-${a}`),b=o?o.classList.contains("text-success"):!1;if(_.isOpen(a)){(!_.getResultId(a)&&b===e||confirm("Are you sure?"))&&(_.remove(a),d(a,!1),document.getElementById(`inner-${a}`).remove());return}let x=document.getElementById(`form-inner-${a}`);(x.value.length===0||E.base64Encode(x.value)===x.getAttribute("data-original")&&b===e||confirm("Are you sure?"))&&(d(a,!1),document.getElementById(`inner-${a}`).remove())},show:S,showMore:(a,n)=>{let e=document.getElementById(`content-${n}`),o=E.base64Decode(e.getAttribute("data-comment")),b=a.getAttribute("data-show")==="false";e.innerHTML=b?o:o.slice(0,F.maxCommentLength)+"...",a.innerText=b?"Sebagian":"Selengkapnya",a.setAttribute("data-show",b?"true":"false")},showOrHide:s}})();var de=(()=>{let r=null,f=()=>{let u=document.getElementById("count-down")?.getAttribute("data-time")?.replace(" ","T");if(!u){alert("invalid count down date.");return}let w=new Date(u).getTime();setInterval(()=>{let $=Math.abs(w-Date.now());document.getElementById("day").innerText=Math.floor($/(1e3*60*60*24)).toString(),document.getElementById("hour").innerText=Math.floor($%(1e3*60*60*24)/(1e3*60*60)).toString(),document.getElementById("minute").innerText=Math.floor($%(1e3*60*60)/(1e3*60)).toString(),document.getElementById("second").innerText=Math.floor($%(1e3*60)/1e3).toString()},1e3)},p=(u,w=.01)=>{let $=document.getElementById(u),y=parseFloat($.style.opacity),L=null;L=setInterval(()=>{if(y>0){$.style.opacity=y.toFixed(3),y-=w;return}clearInterval(L),L=null,$.remove()},10)},m=()=>{let u=window.location.search.split("to="),w=null;if(u.length>1&&u[1].length>=1&&(w=window.decodeURIComponent(u[1])),w){let y=document.getElementById("guest-name"),L=document.createElement("div");L.classList.add("m-2"),L.innerHTML=`<small class="mt-0 mb-1 mx-0 p-0">${y?.getAttribute("data-message")}</small><p class="m-0 p-0" style="font-size: 1.5rem">${E.escapeHtml(w)}</p>`,y?.appendChild(L)}let $=document.getElementById("form-name");$&&($.value=r.get("name")??w)},h=()=>{let u=0,w=document.querySelectorAll(".slide-desktop");w.forEach((y,L)=>{L===u&&(y.classList.add("slide-desktop-active"),E.changeOpacity(y,!0))}),setInterval(async()=>{await E.changeOpacity(w[u],!1),w[u].classList.remove("slide-desktop-active"),u=(u+1)%w.length,w[u].classList.add("slide-desktop-active"),await E.changeOpacity(w[u],!0)},6e3)},i=u=>{u.disabled=!0,document.body.scrollIntoView({behavior:"instant"}),document.dispatchEvent(new Event("undangan.open")),K.isAutoMode()&&(document.getElementById("button-theme").style.display="block"),h(),X.play(),K.spyTop(),re(),p("welcome",.025),E.timeOut(le,1500)},d=u=>{let w=document.getElementById("show-modal-image");w.src=u.src,w.width=u.width,w.height=u.height,se.modal("modal-image").show()},g=()=>r.set("info",!0),I=()=>{document.querySelectorAll(".font-arabic").forEach(u=>{u.innerHTML=String(u.innerHTML).normalize("NFC")})},k=()=>{document.querySelectorAll("svg").forEach(u=>{E.timeOut(()=>u.classList.add(u.getAttribute("data-class")),parseInt(u.getAttribute("data-time")))})},S=()=>{let u=y=>new Date(y+":00Z").toISOString().replace(/[-:]/g,"").split(".")[0],w=new URL("https://calendar.google.com/calendar/render"),$={action:"TEMPLATE",text:"The Wedding of Shinta and Denny",dates:`${u("2025-05-10 00:00")}/${u("2025-05-10 23:59")}`,details:"Tanpa mengurangi rasa hormat, kami mengundang Anda untuk berkenan menghadiri acara pernikahan kami. Terima kasih atas perhatian dan doa restu Anda, yang menjadi kebahagiaan serta kehormatan besar bagi kami.",location:"https://maps.app.goo.gl/cnoJpqGhadFE2WRQ9",ctz:"Asia/Jakarta"};Object.entries($).forEach(([y,L])=>w.searchParams.set(y,L)),document.querySelector("#home button")?.addEventListener("click",()=>window.open(w,"_blank"))},s=async()=>{k(),f(),m(),I(),S(),document.getElementById("root").style.opacity="1",r.has("presence")&&(document.getElementById("form-presence").value=r.get("presence")?"1":"2"),r.get("info")&&document.getElementById("information")?.remove(),window.AOS.init(),document.body.scrollIntoView({behavior:"instant"}),await E.changeOpacity(document.getElementById("welcome"),!0),p("loading",.025)},c=()=>{ae.init(),N.init(),r=R("information");let u=document.body.getAttribute("data-key");if(s(),document.addEventListener("hide.bs.modal",()=>document.activeElement?.blur()),(!u||u.length<=0)&&(X.init(),ee.init().load(),document.getElementById("comment")?.remove(),document.querySelector('a.nav-link[href="#comment"]')?.closest("li.nav-item")?.remove()),u.length>0){N.add(),N.add(),N.add();let w=ee.init();w.hasDataSrc()||w.load();let $=new URLSearchParams(window.location.search);q.setToken($.get("k")??u),window.addEventListener("load",()=>q.guest().then(()=>{N.complete("config"),w.hasDataSrc()&&w.load(),X.init().then(()=>N.complete("audio")).catch(()=>N.invalid("audio")),Z.init(),Z.show().then(()=>N.complete("comment")).catch(()=>N.invalid("comment"))}).catch(()=>N.invalid("config")))}};return{init:()=>(K.init(),q.init(),q.isAdmin()&&(R("user").clear(),R("owns").clear(),R("likes").clear(),R("session").clear(),R("comment").clear(),R("tracker").clear()),window.addEventListener("DOMContentLoaded",c),{util:E,theme:K,comment:Z,guest:{open:i,modal:d,closeInformation:g}})}})();(r=>{r.undangan=de.init()})(window);})();
