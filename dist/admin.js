(()=>{var v=(()=>{let m='<span class="spinner-border spinner-border-sm my-0 ms-0 me-1 p-0" style="height: 0.8rem; width: 0.8rem;"></span>',b=c=>String(c).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),y=(c,u)=>new Promise(k=>{let x=parseFloat(c.style.opacity),P=null,l=u?.05:-.05,p=u?1:0;P=setInterval(()=>{x=Math.max(0,Math.min(1,x+l)),c.style.opacity=x.toFixed(2),x===p&&(k(),clearInterval(P),P=null)},10)}),d=(c,u)=>{let k=null;k=setTimeout(()=>{c(),clearTimeout(k),k=null},u)};return{loader:m,copy:async(c,u=null,k=1500)=>{let x=c.getAttribute("data-copy");if(!x||x.length===0){alert("Nothing to copy");return}c.disabled=!0;try{await navigator.clipboard.writeText(x)}catch{c.disabled=!1,alert("Failed to copy");return}let P=c.innerHTML;c.innerHTML=u||'<i class="fa-solid fa-check"></i>',d(()=>{c.disabled=!1,c.innerHTML=P},k)},timeOut:d,debounce:(c,u)=>{let k=null;return(...x)=>{clearTimeout(k),k=setTimeout(()=>c(...x),u)}},escapeHtml:b,base64Encode:c=>{let k=new TextEncoder().encode(c);return window.btoa(String.fromCharCode(...k))},base64Decode:c=>{let u=new TextDecoder,k=Uint8Array.from(window.atob(c),x=>x.charCodeAt(0));return u.decode(k)},disableButton:(c,u="Loading")=>{c.disabled=!0;let k=c.innerHTML;return c.innerHTML=m+u,{restore:()=>{c.innerHTML=k,c.disabled=!1}}},disableCheckbox:c=>{c.disabled=!0;let u=document.querySelector(`label[for="${c.id}"]`),k=u.innerHTML;return u.innerHTML=m+k,{restore:()=>{u.innerHTML=k,c.disabled=!1}}},parseUserAgent:c=>{let u=[{type:"Mobile",regex:/Android.*Mobile|iPhone|iPod|BlackBerry|IEMobile|Opera Mini/i},{type:"Tablet",regex:/iPad|Android(?!.*Mobile)|Tablet/i},{type:"Desktop",regex:/Windows NT|Macintosh|Linux/i}],k=[{name:"Chrome",regex:/Chrome|CriOS/i},{name:"Safari",regex:/Safari/i},{name:"Edge",regex:/Edg|Edge/i},{name:"Firefox",regex:/Firefox|FxiOS/i},{name:"Opera",regex:/Opera|OPR/i},{name:"Internet Explorer",regex:/MSIE|Trident/i}],x=[{name:"Windows",regex:/Windows NT ([\d.]+)/i},{name:"MacOS",regex:/Mac OS X ([\d_]+)/i},{name:"Android",regex:/Android ([\d.]+)/i},{name:"iOS",regex:/OS ([\d_]+) like Mac OS X/i},{name:"Linux",regex:/Linux/i}],P=u.find(a=>a.regex.test(c))?.type||"Unknown",l=k.find(a=>a.regex.test(c))?.name||"Unknown",p=x.find(a=>a.regex.test(c)),E=p&&c.match(p.regex)?.[1]?.replace(/_/g,".")||"",N=p?p.name:"Unknown";return E=E?`${N} ${E}`:N,`${l} ${P} ${E}`},changeOpacity:y}})();var X={tab:y=>window.bootstrap.Tab.getOrCreateInstance(document.getElementById(y)),modal:y=>window.bootstrap.Modal.getOrCreateInstance(document.getElementById(y))};var q=(()=>{let m=(u,k,x)=>({code:u,data:k,error:x}),b=(u=0)=>({love:u}),y=({uuid:u,own:k,name:x,presence:P,comment:l,created_at:p,is_admin:E,gif_url:N,ip:a,user_agent:n,comments:t,like:s})=>({uuid:u,own:k,name:x,presence:P,comment:l,created_at:p,is_admin:E??!1,gif_url:N,ip:a,user_agent:n,comments:t?.map(y)??[],like:b(s?.love??0)});return{uuidResponse:({uuid:u})=>({uuid:u}),baseResponse:m,tokenResponse:({token:u})=>({token:u}),statusResponse:({status:u})=>({status:u}),commentResponse:({name:u,presence:k,comment:x,is_admin:P,gif_url:l,created_at:p})=>({name:u,presence:k,comment:x,is_admin:P,gif_url:l,created_at:p}),likeCommentResponse:b,getCommentResponse:y,getCommentsResponse:u=>u.map(y),commentShowMore:(u,k=!1)=>({uuid:u,show:k}),postCommentRequest:(u,k,x,P,l)=>({id:u,name:k,presence:x,comment:P,gif_id:l}),postSessionRequest:(u,k)=>({email:u,password:k}),updateCommentRequest:(u,k,x)=>({presence:u,comment:k,gif_id:x})}})();var C=m=>{let b=(r=null)=>{let f=JSON.parse(localStorage.getItem(m));return r?f[String(r)]:f},y=(r,f)=>{let I=b();I[String(r)]=f,localStorage.setItem(m,JSON.stringify(I))},d=r=>Object.keys(b()).includes(String(r)),h=r=>{if(!d(r))return;let f=b();delete f[String(r)],localStorage.setItem(m,JSON.stringify(f))},i=()=>localStorage.setItem(m,"{}");return localStorage.getItem(m)||i(),{set:y,get:b,has:d,clear:i,unset:h}};var z="GET",Y="PUT",J="POST",G="PATCH",ne="DELETE",V=200,Q=201,re=500,_=(m,b)=>{let y=new AbortController,d=document.body.getAttribute("data-url"),h={signal:y.signal,method:String(m).toUpperCase(),headers:new Headers({Accept:"application/json","Content-Type":"application/json"})};return window.addEventListener("offline",()=>y.abort()),window.addEventListener("popstate",()=>y.abort()),window.addEventListener("beforeunload",()=>y.abort()),d.slice(-1)==="/"&&(d=d.slice(0,-1)),{send(i=null){return fetch(d+b,h).then(r=>r.json().then(f=>{if(r.status>=re&&(f.message??f[0]))throw new Error(f.message??f[0]);if(f.error)throw new Error(f.error[0]);return i&&(f.data=i(f.data)),q.baseResponse(f.code,f.data,f.error)})).catch(r=>{if(r.name==="AbortError")return console.warn("Fetch abort:",r),r;throw alert(r),new Error(r)})},download(){return fetch(d+b,h).then(i=>{if(i.status!==V)return!1;let r=document.querySelector("a[download]");r&&document.body.removeChild(r);let f=i.headers.get("content-disposition")?.match(/filename="(.+)"/)?.[1]??"download.csv";return i.blob().then(I=>{let T=document.createElement("a"),M=window.URL.createObjectURL(I);return T.href=M,T.download=f,document.body.appendChild(T),T.click(),document.body.removeChild(T),window.URL.revokeObjectURL(M),!0})}).catch(i=>{if(i.name==="AbortError")return console.warn("Fetch abort:",i),i;throw alert(i),new Error(i)})},withCancel(i){return(async()=>(await i,y.abort()))(),this},default(i=null){return h.headers=new Headers(i??{}),fetch(b,h)},token(i){return i.split(".").length===3?(h.headers.append("Authorization","Bearer "+i),this):(h.headers.append("x-access-key",i),this)},body(i){return h.body=JSON.stringify(i),this}}};var L=(()=>{let m=null,b=()=>m.get("token"),y=T=>m.set("token",T),d=T=>_(J,"/api/session").body(T).send(q.tokenResponse).then(M=>(M.code===V&&y(M.data.token),M.code===V),()=>!1),h=()=>m.unset("token"),i=()=>String(b()??".").split(".").length===3;return{init:()=>{m=C("session")},guest:()=>_(z,"/api/config").token(b()).send().then(T=>{if(T.code!==V)throw new Error("failed to get config.");let M=C("config");for(let[c,u]of Object.entries(T.data))M.set(c,u);return T}),login:d,logout:h,decode:()=>{if(!i())return null;try{return JSON.parse(window.atob(b().split(".")[1]))}catch{return null}},isAdmin:i,setToken:y,getToken:b}})();var W=(()=>{let m=null,b=async r=>{let f=v.disableButton(r),I=document.getElementById("loginEmail"),T=document.getElementById("loginPassword");I.disabled=!0,T.disabled=!0,await L.login(q.postSessionRequest(I.value,T.value))&&(I.value=null,T.value=null,X.modal("mainModal").hide()),f.restore(),I.disabled=!1,T.disabled=!1},y=()=>{m.clear(),L.logout(),X.modal("mainModal").show()};return{init:()=>{m=C("user")},login:b,clearSession:y,getDetailUser:()=>_(z,"/api/user").token(L.getToken()).send().then(r=>{if(r.code!==V)throw new Error("failed to get user.");return Object.entries(r.data).forEach(([f,I])=>m.set(f,I)),r},r=>(y(),r)),getUserStorage:()=>m}})();var se=(()=>{let m=(d,h)=>{document.querySelectorAll(".navbar button").forEach(i=>{i.classList.contains("active")&&i.classList.remove("active")}),X.tab(h).show(),d.classList.add("active")};return{buttonNavHome:d=>{m(d,"button-home")},buttonNavSetting:d=>{m(d,"button-setting")}}})();var Z=(()=>{let m={"#000000":"#ffffff","#ffffff":"#000000","#212529":"#f8f9fa","#f8f9fa":"#212529"},b=["#ffffff","#f8f9fa"],y=["#000000","#212529"],d=!1,h=null,i=null,r=()=>h.set("active","light"),f=()=>h.set("active","dark"),I=l=>{let p=i.getAttribute("content");i.setAttribute("content",l.some(E=>E===p)?m[p]:p)},T=()=>{r(),document.documentElement.setAttribute("data-bs-theme","light"),I(y)},M=()=>{f(),document.documentElement.setAttribute("data-bs-theme","dark"),I(b)},c=(l=null,p=null)=>{let E=h.get("active")==="dark";return l&&p?E?l:p:E};return{init:()=>{switch(h=C("theme"),i=document.querySelector('meta[name="theme-color"]'),h.has("active")||(window.matchMedia("(prefers-color-scheme: dark)").matches?f():r()),document.documentElement.getAttribute("data-bs-theme")){case"dark":f();break;case"light":r();break;default:d=!0}c()?M():T()},spyTop:()=>{let l=E=>E.filter(N=>N.isIntersecting).forEach(N=>{let a=N.target.classList.contains("bg-white-black")?c(y[0],b[0]):c(y[1],b[1]);i.setAttribute("content",a)}),p=new IntersectionObserver(l,{rootMargin:"0% 0% -95% 0%"});document.querySelectorAll("section").forEach(E=>p.observe(E))},change:()=>c()?T():M(),isDarkMode:c,isAutoMode:()=>d}})();var oe=(()=>{let m=null,b=!0,y=()=>b,d=()=>{let c=m.firstElementChild.firstElementChild;c.classList.remove("bg-success"),c.classList.add("bg-danger"),c.firstElementChild.innerHTML='<i class="fa-solid fa-ban me-2"></i>Koneksi tidak tersedia'},h=()=>{let c=m.firstElementChild.firstElementChild;c.classList.remove("bg-danger"),c.classList.add("bg-success"),c.firstElementChild.innerHTML='<i class="fa-solid fa-cloud me-2"></i>Koneksi tersedia kembali'},i=async()=>{await v.changeOpacity(m,!1),d()},r=()=>{let c=null;c=setTimeout(()=>{clearTimeout(c),c=null,b&&i()},3e3)},f=()=>{let c=["input[data-offline-disabled]","button[data-offline-disabled]","select[data-offline-disabled]","textarea[data-offline-disabled]"].join(", ");document.querySelectorAll(c).forEach(u=>{u.dispatchEvent(new Event(y()?"online":"offline")),u.setAttribute("data-offline-disabled",y()?"false":"true"),u.tagName==="BUTTON"?y()?u.classList.remove("disabled"):u.classList.add("disabled"):y()?u.removeAttribute("disabled"):u.setAttribute("disabled","true")})},I=()=>{b=!1,d(),v.changeOpacity(m,!0),f()},T=()=>{b=!0,h(),r(),f()};return{init:()=>{window.addEventListener("online",T),window.addEventListener("offline",I),m=document.getElementById("offline-mode"),m.innerHTML=`
        <div class="d-flex justify-content-center mx-auto">
            <div class="d-flex justify-content-center align-items-center rounded-pill my-2 bg-danger shadow">
                <small class="text-center py-1 px-2 mx-1 mt-1 mb-0 text-white" style="font-size: 0.8rem;"></small>
            </div>
        </div>`},isOnline:y}})();var D=(()=>{let m="gifs",b="default",y={128:2,256:3,512:4,768:5},d={id:"ID",en:"US",fr:"FR",de:"DE",es:"ES",zh:"CN",ja:"JP",ko:"KR",ar:"SA",ru:"RU",it:"IT",nl:"NL",pt:"PT",tr:"TR",th:"TH",vi:"VN",ms:"MY",hi:"IN"},h=null,i=null,r=null,f=null,I=async e=>{if(h.has(e))return h.get(e);let o=(w,H=3,R=1e3)=>_(z,e).default().then(O=>O.blob().then(K=>w.put(e,new Response(K,{headers:new Headers(O.headers)})).then(()=>K))).catch(O=>{if(H<=0)throw O;return console.warn("Retrying fetch:"+e),new Promise(K=>v.timeOut(()=>K(o(w,H-1,R+1e3)),R))}),B=w=>w.match(e).then(H=>{if(!H)return o(w);let R=H.headers.get("expires"),O=R?new Date(R).getTime():0;return Date.now()>O?w.delete(e).then(K=>K?o(w):H.blob()):H.blob()});return await caches.open(m).then(w=>B(w)).then(w=>URL.createObjectURL(w)).then(w=>(h.set(e,w),w))},T=async(e,o)=>{let{id:B,media_formats:{tinygif:{url:A}},content_description:w}=o;e.pointer===-1||e.pointer===e.col-1?e.pointer=0:e.pointer++;let H=0;for(let R of e.lists.childNodes)H===e.pointer&&await I(A).then(O=>{R.insertAdjacentHTML("beforeend",`
                    <figure class="gif-figure m-0 position-relative">
                        <div onclick="undangan.comment.gif.click('${e.uuid}', '${B}', '${v.base64Encode(A)}')" class="gif-checklist position-absolute justify-content-center align-items-center top-0 end-0 bg-overlay-auto p-1 m-1 rounded-circle border shadow-sm z-1">
                            <i class="fa-solid fa-circle-check"></i>
                        </div>
                        <img src="${O}" class="img-fluid" alt="${v.escapeHtml(w)}" style="width: 100%;">
                    </figure>
                `)}),H++},M=e=>{let o=e.lists,B=document.getElementById(`gif-loading-${e.uuid}`);return o.classList.contains("d-none")||B.classList.replace("d-none","d-flex"),o.setAttribute("data-continue","false"),o.classList.replace("overflow-y-scroll","overflow-y-hidden"),{release:()=>{o.classList.contains("d-none")||B.classList.replace("d-flex","d-none"),o.setAttribute("data-continue","true"),o.classList.replace("overflow-y-hidden","overflow-y-scroll")}}},c=(e,o,B)=>{let A=!0;e.last=new Promise(w=>{let H=M(e);(async()=>(await o,A=!1))(),(async()=>{try{let R=await B;e.next=R?.next;for(let O of R.results)A&&(e.gifs.push(O),await T(e,O))}catch(R){R.name==="AbortError"?console.warn("Fetch abort:",R):alert(R)}finally{H.release(),w()}})()})},u=(e,o)=>{o={key:f.get("tenor_key"),media_filter:"tinygif",client_key:"undangan_app",country:f.get("country"),locale:f.get("locale"),...o??{}};let B=Object.keys(o).filter(w=>o[w]!==null&&o[w]!==void 0).filter(w=>typeof o[w]!="object").map(w=>`${w}=${encodeURIComponent(o[w])}`).join("&"),A=_(z,`https://tenor.googleapis.com/v2${e}?${B}`);return o.reqCancel&&(A=A.withCancel(o.reqCancel)),A.default().then(w=>w.json()).then(w=>{if(!w.error)return w;throw new Error(w.error.message)})},k=async e=>{if(!e.next||e.next.length===0)return;let o=e.query&&e.query.trim().length,B={pos:e.next,limit:e.limit};o&&(B.q=e.query),e.last&&(await e.last,e.last=null),B.reqCancel=new Promise(w=>{e.reqs.push(w)});let A=(e.lists.scrollHeight-e.lists.clientHeight)*.9;e.lists.scrollTop>A&&e.lists.getAttribute("data-continue")==="true"&&c(e,B.reqCancel,u(o?"/search":"/featured",B))},x=e=>`
        <label for="gif-search-${e}" class="form-label my-1"><i class="fa-solid fa-photo-film me-2"></i>Gif</label>

        <div class="d-flex mb-3" id="gif-search-nav-${e}">
            <button class="btn btn-secondary btn-sm rounded-4 shadow-sm me-1 my-1" onclick="undangan.comment.gif.back('${e}')" data-offline-disabled="false"><i class="fa-solid fa-arrow-left"></i></button>
            <input type="text" name="gif-search" id="gif-search-${e}" autocomplete="off" class="form-control shadow-sm rounded-4" placeholder="Cari GIF oleh Tenor" data-offline-disabled="false">
        </div>

        <div class="position-relative">
            <div class="position-absolute d-flex justify-content-center align-items-center top-50 start-50 translate-middle w-100 h-100 bg-overlay-auto rounded-4 z-3" id="gif-loading-${e}">
                <div class="spinner-border" role="status"></div>
            </div>
            <div id="gif-lists-${e}" class="d-flex rounded-4 p-0 overflow-y-scroll border" data-continue="true" style="height: 15rem;"></div>
        </div>

        <figure class="d-flex m-0 position-relative" id="gif-result-${e}">
            <div onclick="undangan.comment.gif.cancel('${e}')" id="gif-cancel-${e}" class="d-none position-absolute justify-content-center align-items-center top-0 end-0 bg-overlay-auto p-2 m-1 rounded-circle border shadow-sm z-1" style="cursor: pointer;">
                <i class="fa-solid fa-circle-xmark"></i>
            </div>
        </figure>`,P=async e=>{let o=0;for(let[A,w]of Object.entries(y))o=w,e.lists.clientWidth>=parseInt(A)&&(e.col=o);if(e.col===null&&(e.col=o),e.pointer=-1,e.limit=e.col*5,e.lists.innerHTML='<div class="d-flex flex-column"></div>'.repeat(e.col),e.gifs.length===0)return;let B=M(e);for(let A of e.gifs)await T(e,A);B.release()},l=async(e,o)=>{e.query=o.value,(!e.query||e.query.trim().length===0)&&(e.query=null),e.reqs.forEach(A=>A()),e.reqs=[],e.last&&(await e.last,e.last=null);let B=new Promise(A=>{e.reqs.push(A)});e.next=null,e.gifs=[],e.pointer=-1,await P(e),c(e,B,u(e.query===null?"/featured":"/search",{q:e.query,limit:e.limit,reqCancel:B}))},p=e=>{if(!i.has(e)){let o=document.getElementById(`gif-form-${e}`);o.innerHTML=x(e);let B=v.debounce(P,500),A=v.debounce(l,500);i.set(e,{uuid:e,last:null,limit:null,query:null,next:null,col:null,pointer:-1,gifs:[],reqs:[],container:o,lists:document.getElementById(`gif-lists-${e}`),result:document.getElementById(`gif-result-${e}`)});let w=i.get(e);w.lists.addEventListener("scroll",()=>k(w)),window.addEventListener("resize",()=>B(w)),document.getElementById(`gif-search-${e}`).addEventListener("input",H=>A(w,H.target))}return i.get(e)};return{default:b,init:()=>{h=new Map,r=new Map,i=new Map,f=C("config");let e=document.documentElement.lang.toLowerCase();f.set("country",d[e]??"US"),f.set("locale",`${e}_${f.get("country")}`),f.get("tenor_key")===null&&document.querySelector('[onclick="undangan.comment.gif.open(undangan.comment.gif.default)"]')?.remove()},cache:I,back:e=>{p(e).container.classList.toggle("d-none",!0),document.getElementById(`comment-form-${e}`)?.classList.toggle("d-none",!1)},open:async e=>{let o=p(e);o.container.classList.toggle("d-none",!1),document.getElementById(`comment-form-${e}`)?.classList.toggle("d-none",!0),r.has(e)&&r.get(e)(),o.reqs.forEach(A=>A()),o.reqs=[],o.last&&(await o.last,o.last=null);let B=new Promise(A=>{o.reqs.push(A)});await P(o),c(o,B,u("/featured",{limit:o.limit,reqCancel:B}))},cancel:e=>{let o=p(e);o.result.removeAttribute("data-id"),o.result.querySelector(`#gif-cancel-${e}`).classList.replace("d-flex","d-none"),o.result.querySelector("img").remove(),o.lists.classList.replace("d-none","d-flex"),document.getElementById(`gif-search-nav-${e}`).classList.replace("d-none","d-flex")},click:(e,o,B)=>{let A=p(e);A.result.setAttribute("data-id",o),A.result.querySelector(`#gif-cancel-${e}`).classList.replace("d-none","d-flex"),A.result.insertAdjacentHTML("beforeend",`<img src="${h.get(v.base64Decode(B))}" class="img-fluid mx-auto gif-image rounded-4" alt="selected-gif">`),A.lists.classList.replace("d-flex","d-none"),document.getElementById(`gif-search-nav-${e}`).classList.replace("d-flex","d-none"),u("/registershare",{id:o,q:A.query})},remove:(e=null)=>{e?i.has(e)&&(i.get(e).reqs.forEach(o=>o()),i.delete(e),r.delete(e)):(i.forEach(o=>o.reqs.forEach(B=>B())),i.clear(),r.clear())},isOpen:e=>{if(!i.has(e))return!1;let o=i.get(e);return o.container===null?!1:!o.container.classList.contains("d-none")},onOpen:(e,o)=>r.set(e,o),getResultId:e=>i.get(e)?.result?.getAttribute("data-id"),getAttribute:(e,o)=>{try{return i.get(e)[o]}catch{return null}}}})();var j=(()=>{let m=null,b=null,y=null,d=null,h=null,i=null,r=250,f=[["*",'<strong class="text-theme-auto">$1</strong>'],["_",'<em class="text-theme-auto">$1</em>'],["~",'<del class="text-theme-auto">$1</del>'],["```",'<code class="font-monospace text-theme-auto">$1</code>']],I=()=>`
        <div class="bg-theme-auto shadow p-3 mx-0 mt-0 mb-3 rounded-4">
            <div class="d-flex justify-content-between align-items-center placeholder-wave">
                <span class="placeholder bg-secondary col-5 rounded-3 my-1"></span>
                <span class="placeholder bg-secondary col-3 rounded-3 my-1"></span>
            </div>
            <hr class="my-1">
            <p class="placeholder-wave m-0">
                <span class="placeholder bg-secondary col-6 rounded-3"></span>
                <span class="placeholder bg-secondary col-5 rounded-3"></span>
                <span class="placeholder bg-secondary col-12 rounded-3 my-1"></span>
            </p>
        </div>`,T=t=>(f.forEach(s=>{let g=s[0],$=s[1];t=t.replace(new RegExp(`\\${g}(?=\\S)(.*?)(?<!\\s)\\${g}`,"gs"),$)}),t),M=t=>`
        <button style="font-size: 0.8rem;" onclick="undangan.comment.like.love(this)" data-uuid="${t.uuid}" class="btn btn-sm btn-outline-auto ms-auto rounded-3 p-0 shadow-sm d-flex justify-content-start align-items-center" data-offline-disabled="false">
            <span class="my-0 mx-1" data-count-like="${t.like.love}">${t.like.love}</span>
            <i class="me-1 ${y.has(t.uuid)?"fa-solid fa-heart text-danger":"fa-regular fa-heart"}"></i>
        </button>`,c=t=>{let s=t.gif_url!==null&&t.gif_url!==void 0,g=`<div class="d-flex justify-content-start align-items-center" data-button-action="${t.uuid}">`;return(d.get("can_reply")===!0||d.get("can_reply")===void 0)&&(g+=`<button style="font-size: 0.8rem;" onclick="undangan.comment.reply(this)" data-uuid="${t.uuid}" class="btn btn-sm btn-outline-auto rounded-4 py-0 me-1 shadow-sm" data-offline-disabled="false">Reply</button>`),b.has(t.uuid)&&(d.get("can_edit")===!0||d.get("can_edit")===void 0)&&!(s&&d.get("tenor_key")===null)&&(g+=`<button style="font-size: 0.8rem;" onclick="undangan.comment.edit(this)" data-uuid="${t.uuid}" class="btn btn-sm btn-outline-auto rounded-4 py-0 me-1 shadow-sm" data-offline-disabled="false">Edit</button>`),L.isAdmin()?g+=`<button style="font-size: 0.8rem;" onclick="undangan.comment.remove(this)" data-uuid="${t.uuid}" class="btn btn-sm btn-outline-auto rounded-4 py-0 me-1 shadow-sm" data-own="${t.own}" data-offline-disabled="false">Delete</button>`:b.has(t.uuid)&&(d.get("can_delete")===!0||d.get("can_delete")===void 0)&&(g+=`<button style="font-size: 0.8rem;" onclick="undangan.comment.remove(this)" data-uuid="${t.uuid}" class="btn btn-sm btn-outline-auto rounded-4 py-0 me-1 shadow-sm" data-offline-disabled="false">Delete</button>`),g+="</div>",g},u=(t,s)=>{let g=i.get("show").includes(t);return`<a class="text-theme-auto" style="font-size: 0.8rem;" onclick="undangan.comment.showOrHide(this)" data-uuid="${t}" data-uuids="${s.join(",")}" data-show="${g?"true":"false"}" role="button" class="me-auto ms-1 py-0">${g?"Hide replies":`Show replies (${s.length})`}</a>`},k=t=>`
        <div class="d-flex justify-content-between align-items-center" id="button-${t.uuid}">
            ${c(t)}
            ${t.comments.length>0?u(t.uuid,t.comments.map(s=>s.uuid)):""}
            ${M(t)}
        </div>`,x=t=>t.ip===void 0||t.user_agent===void 0||t.is_admin?"":`
        <div class="mb-1 mt-3">
            <p class="text-theme-auto mb-1 mx-0 mt-0 p-0" style="font-size: 0.7rem;" id="ip-${t.uuid}"><i class="fa-solid fa-location-dot me-1"></i>${v.escapeHtml(t.ip)} ${h.has(t.ip)?`<strong>${h.get(t.ip)}</strong>`:'<span class="mb-1 placeholder col-2 rounded-3"></span>'}</p>
            <p class="text-theme-auto m-0 p-0" style="font-size: 0.7rem;"><i class="fa-solid fa-mobile-screen-button me-1"></i>${v.parseUserAgent(v.escapeHtml(t.user_agent))}</p>
        </div>`,P=(t,s)=>s?'class="bg-theme-auto shadow p-3 mx-0 mt-0 mb-3 rounded-4" data-parent="true"':`class="${i.get("hidden").find(g=>g.uuid===t.uuid).show?"":"d-none"} overflow-x-scroll mw-100 border-start bg-theme-auto py-2 ps-2 pe-0 my-2 ms-2 me-0"`,l=(t,s)=>t.is_admin?`<strong class="me-1">${v.escapeHtml(m.get("name")??d.get("name"))}</strong><i class="fa-solid fa-certificate text-primary"></i>`:s?`<strong class="me-1">${v.escapeHtml(t.name)}</strong><i id="badge-${t.uuid}" class="fa-solid ${t.presence?"fa-circle-check text-success":"fa-circle-xmark text-danger"}"></i>`:`<strong>${v.escapeHtml(t.name)}</strong>`,p=async(t,s)=>{let g=T(v.escapeHtml(t.comment)),$=g.length>r,S=t.gif_url!==null&&t.gif_url!==void 0,U=`
        <div class="d-flex justify-content-between align-items-center">
            <p class="text-theme-auto text-truncate m-0 p-0" style="font-size: 0.95rem;">${l(t,s)}</p>
            <small class="text-theme-auto m-0 p-0" style="font-size: 0.75rem;">${t.created_at}</small>
        </div>
        <hr class="my-1">
        `;if(S){let e=await D.cache(t.gif_url);return U+`
            <div class="d-flex justify-content-center align-items-center my-2">
                <img src="${e}" id="img-gif-${t.uuid}" class="img-fluid mx-auto gif-image rounded-4" alt="selected-gif">
            </div>
            `}return U+`
        <p class="text-theme-auto my-1 mx-0 p-0" style="white-space: pre-wrap !important; font-size: 0.95rem;" ${$?`data-comment="${v.base64Encode(g)}"`:""} id="content-${t.uuid}">${$?g.slice(0,r)+"...":g}</p>
        ${$?`<p class="d-block mb-2 mt-0 mx-0 p-0"><a class="text-theme-auto" role="button" style="font-size: 0.85rem; display: block;" data-show="false" onclick="undangan.comment.showMore(this, '${t.uuid}')">Selengkapnya</a></p>`:""}`},E=async(t,s)=>{let g=await p(t,s),$="";for(let S of t.comments)$+=await E(S,!1);return`
        <div ${P(t,s)} id="${t.uuid}" style="overflow-wrap: break-word !important;">
            <div id="body-content-${t.uuid}" data-tapTime="0" data-liked="false" tabindex="0">
                ${g}
            </div>
            ${x(t)}
            ${k(t)}
            <div id="reply-content-${t.uuid}">${$}</div>
        </div>`};return{init:()=>{m=C("user"),b=C("owns"),y=C("likes"),d=C("config"),h=C("tracker"),i=C("comment")},renderEdit:(t,s,g,$)=>{let S=document.createElement("div");return S.classList.add("my-2"),S.id=`inner-${t}`,S.innerHTML=`
        <p class="my-1 mx-0 p-0" style="font-size: 0.95rem;"><i class="fa-solid fa-pen me-2"></i>Edit</p>
        ${g?`
        <select class="form-select shadow-sm mb-2 rounded-4" id="form-inner-presence-${t}" data-offline-disabled="false">
            <option value="1" ${s?"selected":""}>Datang</option>
            <option value="2" ${s?"":"selected"}>Berhalangan</option>
        </select>`:""}
        ${$?`${d.get("tenor_key")===null?"":`<div class="d-none mb-2" id="gif-form-${t}"></div>`}`:`<textarea class="form-control shadow-sm rounded-4 mb-2" id="form-inner-${t}" minlength="1" maxlength="1000" placeholder="Type update comment" rows="3" data-offline-disabled="false"></textarea>    
        `}
        <div class="d-flex justify-content-end align-items-center mb-0">
            <button style="font-size: 0.8rem;" onclick="undangan.comment.cancel('${t}')" class="btn btn-sm btn-outline-auto rounded-4 py-0 me-1" data-offline-disabled="false">Cancel</button>
            <button style="font-size: 0.8rem;" onclick="undangan.comment.update(this)" data-uuid="${t}" class="btn btn-sm btn-outline-auto rounded-4 py-0" data-offline-disabled="false">Update</button>
        </div>`,S},renderReply:t=>{let s=document.createElement("div");return s.classList.add("my-2"),s.id=`inner-${t}`,s.innerHTML=`
        <p class="my-1 mx-0 p-0" style="font-size: 0.95rem;"><i class="fa-solid fa-reply me-2"></i>Reply</p>
        <div class="d-block mb-2" id="comment-form-${t}">
            <div class="position-relative">
                ${d.get("tenor_key")===null?"":`<button class="btn btn-secondary btn-sm rounded-4 shadow-sm me-1 my-1 position-absolute bottom-0 end-0" onclick="undangan.comment.gif.open('${t}')" aria-label="button gif" data-offline-disabled="false"><i class="fa-solid fa-photo-film"></i></button>`}
                <textarea class="form-control shadow-sm rounded-4 mb-2" id="form-inner-${t}" minlength="1" maxlength="1000" placeholder="Type reply comment" rows="3" data-offline-disabled="false"></textarea>
            </div>
        </div>
        <div class="d-none mb-2" id="gif-form-${t}"></div>
        <div class="d-flex justify-content-end align-items-center mb-0">
            <button style="font-size: 0.8rem;" onclick="undangan.comment.cancel('${t}')" class="btn btn-sm btn-outline-auto rounded-4 py-0 me-1" data-offline-disabled="false">Cancel</button>
            <button style="font-size: 0.8rem;" onclick="undangan.comment.send(this)" data-uuid="${t}" class="btn btn-sm btn-outline-auto rounded-4 py-0" data-offline-disabled="false">Send</button>
        </div>`,s},renderLoading:I,renderReadMore:u,renderInnerContent:t=>E(t,!1),renderContent:t=>E(t,!0),convertMarkdownToHTML:T,maxCommentLength:r}})();var le=()=>window.confetti.shapeFromPath({path:"M167 72c19,-38 37,-56 75,-56 42,0 76,33 76,75 0,76 -76,151 -151,227 -76,-76 -151,-151 -151,-227 0,-42 33,-75 75,-75 38,0 57,18 76,56z",matrix:[.03333333333333333,0,0,.03333333333333333,-5.566666666666666,-5.533333333333333]});var ae=m=>{if(!window.confetti)return;let b=Date.now()+25,y=Math.max(.3,Math.min(1,m.getBoundingClientRect().top/window.innerHeight+.2)),d=le(),h=["#FF69B4","#FF1493"];(function i(){h.forEach(r=>{window.confetti({particleCount:2,angle:60,spread:55,shapes:[d],origin:{x:0,y},zIndex:1057,colors:[r]}),window.confetti({particleCount:2,angle:120,spread:55,shapes:[d],origin:{x:1,y},zIndex:1057,colors:[r]})}),Date.now()<b&&requestAnimationFrame(i)})()};var ee=(()=>{let m=null,b=async h=>{let i=h.firstElementChild,r=h.lastElementChild,f=h.getAttribute("data-uuid"),I=parseInt(i.getAttribute("data-count-like"));h.disabled=!0,m.has(f)?await _(G,"/api/comment/"+m.get(f)).token(L.getToken()).send(q.statusResponse).then(T=>{T.data.status&&(m.unset(f),r.classList.remove("fa-solid","text-danger"),r.classList.add("fa-regular"),i.setAttribute("data-count-like",String(I-1)))}):await _(J,"/api/comment/"+f).token(L.getToken()).send(q.uuidResponse).then(T=>{T.code===Q&&(m.set(f,T.data.uuid),r.classList.remove("fa-regular"),r.classList.add("fa-solid","text-danger"),i.setAttribute("data-count-like",String(I+1)))}),i.innerText=i.getAttribute("data-count-like"),h.disabled=!1};return{init:()=>{m=C("likes")},love:b,tapTap:async h=>{if(!navigator.onLine)return;let i=Date.now(),r=i-parseInt(h.getAttribute("data-tapTime")),f=h.id.replace("body-content-",""),I=r<300&&r>0,T=!m.has(f)&&h.getAttribute("data-liked")!=="true";if(I&&T){navigator.vibrate&&navigator.vibrate(100),ae(h);let M=document.querySelector(`[onclick="undangan.comment.like.love(this)"][data-uuid="${f}"]`);h.setAttribute("data-liked","true"),await b(M),h.setAttribute("data-liked","false")}h.setAttribute("data-tapTime",i)}}})();var F=(()=>{let m=10,b=0,y=0,d=null,h=null,i=null,r=null,f=null,I=s=>{m=Number(s)},T=()=>m,M=()=>b,c=()=>y,u=()=>h.classList.contains("disabled")?null:h.classList.add("disabled"),k=()=>h.classList.contains("disabled")?h.classList.remove("disabled"):null,x=()=>i.classList.contains("disabled")?null:i.classList.add("disabled"),P=()=>i.classList.contains("disabled")?i.classList.remove("disabled"):null,l=()=>{r.classList.contains("d-none")&&r.classList.remove("d-none")},p=s=>{s.disabled=!0;let g=s.innerHTML;s.innerHTML=v.loader.replace("ms-0 me-1","mx-1");let $=async()=>{let e=new Promise(o=>f.addEventListener("comment.result",o));f.dispatchEvent(new Event("comment.show")),await e,s.disabled=!1,s.innerHTML=g,f.scrollIntoView({behavior:"smooth"})};return{next:async()=>{b+=m,s.innerHTML="Next"+s.innerHTML,await $(),d.innerText=String(parseInt(d.innerText)+1)},prev:async()=>{b-=m,s.innerHTML=s.innerHTML+"Prev",await $(),d.innerText=String(parseInt(d.innerText)-1)}}};return{init:()=>{r=document.getElementById("pagination"),r.innerHTML=`
        <ul class="pagination mb-2 shadow-sm rounded-4">
            <li class="page-item disabled" id="previous">
                <button class="page-link rounded-start-4" onclick="undangan.comment.pagination.previous(this)" data-offline-disabled="false">
                    <i class="fa-solid fa-circle-left me-1"></i>Prev
                </button>
            </li>
            <li class="page-item disabled">
                <span class="page-link text-theme-auto" id="page">1</span>
            </li>
            <li class="page-item" id="next">
                <button class="page-link rounded-end-4" onclick="undangan.comment.pagination.next(this)" data-offline-disabled="false">
                    Next<i class="fa-solid fa-circle-right ms-1"></i>
                </button>
            </li>
        </ul>`,f=document.getElementById("comments"),d=document.getElementById("page"),h=document.getElementById("previous"),i=document.getElementById("next")},setPer:I,getPer:T,getNext:M,reset:()=>b===0?!1:(b=0,y=0,d.innerText=1,x(),u(),!0),setResultData:s=>{if(y=s,b>0&&k(),y<m){x();return}P(),l()},getResultData:c,previous:async s=>{u(),!(b<0)&&(x(),await p(s).prev())},next:async s=>{x(),!(y<m)&&(u(),await p(s).next())}}})();var te=(()=>{let m=null,b=null,y=null,d=null,h=[],i=()=>'<div class="text-center p-4 my-2 bg-theme-auto rounded-4 shadow"><p class="fw-bold p-0 m-0" style="font-size: 0.95rem;">Yuk bagikan undangan ini biar banyak komentarnya</p></div>',r=(a,n)=>{document.querySelector(`[data-button-action="${a}"]`).childNodes.forEach(t=>{t.disabled=n})},f=a=>{a.comments&&a.comments.forEach(f);let n=document.getElementById(`body-content-${a.uuid}`);n.addEventListener("touchend",()=>ee.tapTap(n))},I=a=>{if(!L.isAdmin()||(a.comments&&a.comments.forEach(I),a.ip===void 0||a.user_agent===void 0||a.is_admin||y.has(a.ip)))return;let n=(t,s,g)=>{document.getElementById(`ip-${t}`).innerHTML=`<i class="fa-solid fa-location-dot me-1"></i>${v.escapeHtml(s)} <strong>${v.escapeHtml(g)}</strong>`};_(z,`https://freeipapi.com/api/json/${a.ip}`).default().then(t=>t.json()).then(t=>{let s=t.cityName+" - "+t.regionName;t.cityName==="-"&&t.regionName==="-"&&(s="localhost"),y.set(a.ip,s),n(a.uuid,a.ip,s)}).catch(t=>n(a.uuid,a.ip,t.message))},T=(a,n=[])=>(a.forEach(t=>{n.find(s=>s.uuid===t.uuid)||n.push(q.commentShowMore(t.uuid)),t.comments&&t.comments.length>0&&T(t.comments,n)}),n),M=()=>{let a=document.getElementById("comments");return a.getAttribute("data-loading")==="false"&&(a.setAttribute("data-loading","true"),a.innerHTML=j.renderLoading().repeat(F.getPer())),_(z,`/api/comment?per=${F.getPer()}&next=${F.getNext()}`).token(L.getToken()).send(q.getCommentsResponse).then(async n=>{let t=n.data.length;if(a.setAttribute("data-loading","false"),h.map(g=>g.uuid).forEach(g=>D.remove(g)),t===0)return F.setResultData(t),a.innerHTML=i(),n;h=T(n.data),d.set("hidden",T(n.data,d.get("hidden")));let s="";for(let g of n.data)s+=await j.renderContent(g);return a.innerHTML=s,n.data.forEach(I),n.data.forEach(f),F.setResultData(t),a.dispatchEvent(new Event("comment.result")),n})},c=a=>{let n=a.getAttribute("data-uuids").split(","),t=a.getAttribute("data-show")==="true",s=a.getAttribute("data-uuid");t?(a.setAttribute("data-show","false"),a.innerText=`Show replies (${n.length})`,d.set("show",d.get("show").filter(g=>g!==s))):(a.setAttribute("data-show","true"),a.innerText="Hide replies",d.set("show",d.get("show").concat([s])));for(let g of n){d.set("hidden",d.get("hidden").map(S=>(S.uuid===g&&(S.show=!t),S)));let $=document.getElementById(g).classList;t?$.add("d-none"):$.remove("d-none")}};return{gif:D,like:ee,pagination:F,init:()=>{D.init(),ee.init(),j.init(),F.init(),document.getElementById("comments").addEventListener("comment.show",M),m=C("owns"),b=C("user"),y=C("tracker"),d=C("comment"),d.has("hidden")||d.set("hidden",[]),d.has("show")||d.set("show",[])},send:async a=>{let n=a.getAttribute("data-uuid"),t=document.getElementById("form-name"),s=t.value;if(L.isAdmin()&&(s=b.get("name")),s.length===0){alert("Name cannot be empty."),n&&document.getElementById("comment").scrollIntoView({behavior:"smooth"});return}let g=document.getElementById("form-presence");if(!n&&g&&g.value==="0"){alert("Please select your attendance status.");return}let $=D.isOpen(n||"default"),S=D.getResultId(n||"default"),U=document.getElementById(`gif-cancel-${n||"default"}`);if($&&!S){alert("Gif cannot be empty.");return}$&&S&&U.classList.replace("d-flex","d-none");let e=document.getElementById(`form-${n?`inner-${n}`:"comment"}`);if(!$&&e.value.length===0){alert("Comments cannot be empty.");return}!n&&t&&!L.isAdmin()&&(t.disabled=!0),!L.isAdmin()&&g&&g.value!=="0"&&(g.disabled=!0),e&&(e.disabled=!0);let o=document.querySelector(`[onclick="undangan.comment.cancel('${n}')"]`);o&&(o.disabled=!0);let B=v.disableButton(a),A=g?g.value==="1":!0;if(!L.isAdmin()){let H=C("information");H.set("name",s),n||H.set("presence",A)}let w=await _(J,"/api/comment").token(L.getToken()).body(q.postCommentRequest(n,s,A,D.isOpen(n)?null:e.value,S)).send(q.getCommentResponse).then(H=>H,()=>null);if(t&&(t.disabled=!1),e&&(e.disabled=!1),o&&(o.disabled=!1),g&&(g.disabled=!1),$&&S&&U.classList.replace("d-none","d-flex"),B.restore(),!(!w||w.code!==Q)){if(m.set(w.data.uuid,w.data.own),e&&(e.value=null),$&&S&&U.dispatchEvent(new Event("click")),!n){let H=document.getElementById("comments");if(await F.reset()){await M(),H.scrollIntoView({behavior:"smooth"});return}F.setResultData(H.children.length),F.getResultData()===F.getPer()&&H.lastElementChild.remove(),w.data.is_admin=L.isAdmin();let O=await j.renderContent(w.data);H.insertAdjacentHTML("afterbegin",O),H.scrollIntoView({behavior:"smooth"})}if(n){d.set("hidden",d.get("hidden").concat([q.commentShowMore(w.data.uuid,!0)])),d.set("show",d.get("show").concat([n])),r(n,!1),document.getElementById(`inner-${n}`).remove(),w.data.is_admin=L.isAdmin(),document.getElementById(`reply-content-${n}`).insertAdjacentHTML("beforeend",await j.renderInnerContent(w.data));let H=document.getElementById(`button-${n}`),R=H.querySelector("a"),O=[w.data.uuid];R&&(R.getAttribute("data-show")==="false"&&c(R),R.remove());let K=`button[onclick="undangan.comment.like.love(this)"][data-uuid="${n}"]`;H.querySelector(K).insertAdjacentHTML("beforebegin",j.renderReadMore(n,R?R.getAttribute("data-uuids").split(",").concat(O):O))}f(w.data)}},edit:async a=>{let n=a.getAttribute("data-uuid");if(document.getElementById(`inner-${n}`))return;r(n,!0);let t=v.disableButton(a);await _(z,"/api/comment/"+n).token(L.getToken()).send(q.commentResponse).then(s=>{if(s.code!==V)return s;let g=s.data.gif_url!==null&&s.data.gif_url!==void 0;g&&D.remove(n);let $=document.getElementById(n).getAttribute("data-parent")==="true"&&!L.isAdmin();if(document.getElementById(`button-${n}`).insertAdjacentElement("afterend",j.renderEdit(n,s.data.presence,$,g)),g)return D.onOpen(n,()=>{document.querySelector(`[for="gif-search-${n}"]`)?.remove(),document.querySelector(`[onclick="undangan.comment.gif.back('${n}')"]`)?.remove()}),D.open(n);let S=document.getElementById(`form-inner-${n}`);return S.value=s.data.comment,S.setAttribute("data-original",v.base64Encode(s.data.comment)),s}),t.restore(),a.disabled=!0},reply:a=>{let n=a.getAttribute("data-uuid");document.getElementById(`inner-${n}`)||(D.remove(n),r(n,!0),document.getElementById(`button-${n}`).insertAdjacentElement("afterend",j.renderReply(n)),D.onOpen(n,()=>document.querySelector(`[for="gif-search-${n}"]`)?.remove()))},remove:async a=>{if(!confirm("Are you sure?"))return;let n=a.getAttribute("data-uuid");L.isAdmin()&&m.set(n,a.getAttribute("data-own")),r(n,!0);let t=v.disableButton(a),s=document.querySelector(`[onclick="undangan.comment.like.love(this)"][data-uuid="${n}"]`);if(s.disabled=!0,!await _(ne,"/api/comment/"+m.get(n)).token(L.getToken()).send(q.statusResponse).then(S=>S.data.status,()=>!1)){t.restore(),s.disabled=!1;return}document.querySelectorAll('a[onclick="undangan.comment.showOrHide(this)"]').forEach(S=>{let U=S.getAttribute("data-uuids").split(",");if(U.find(e=>e===n)){let e=U.filter(o=>o!==n).join(",");e.length===0?S.remove():S.setAttribute("data-uuids",e)}}),m.unset(n),document.getElementById(n).remove();let $=document.getElementById("comments");$.children.length===0&&($.innerHTML=i())},update:async a=>{let n=a.getAttribute("data-uuid"),t=!1,s=document.getElementById(`form-inner-presence-${n}`);s&&(s.disabled=!0,t=s.value==="1");let g=!1,$=document.getElementById(`badge-${n}`);$&&(g=$.classList.contains("text-success"));let S=D.isOpen(n),U=D.getResultId(n),e=document.getElementById(`gif-cancel-${n}`),o=document.getElementById(`form-inner-${n}`);if(S&&U&&e.classList.replace("d-flex","d-none"),n&&!S&&v.base64Encode(o.value)===o.getAttribute("data-original")&&g===t){r(n,!1),document.getElementById(`inner-${n}`).remove();return}o&&(o.disabled=!0);let B=document.querySelector(`[onclick="undangan.comment.cancel('${n}')"]`);B&&(B.disabled=!0);let A=v.disableButton(a),w=await _(Y,"/api/comment/"+m.get(n)).token(L.getToken()).body(q.updateCommentRequest(s?t:null,D.isOpen(n)?null:o.value,U)).send(q.statusResponse).then(H=>H.data.status,()=>!1);if(o&&(o.disabled=!1),B&&(B.disabled=!1),s&&(s.disabled=!1),A.restore(),S&&U&&e.classList.replace("d-none","d-flex"),!!w){if(S&&U&&(document.getElementById(`img-gif-${n}`).src=D.getAttribute(n,"result").querySelector("img").src,e.dispatchEvent(new Event("click"))),r(n,!1),document.getElementById(`inner-${n}`).remove(),!S){let H=document.querySelector(`[onclick="undangan.comment.showMore(this, '${n}')"]`),R=j.convertMarkdownToHTML(v.escapeHtml(o.value)),O=document.getElementById(`content-${n}`);R.length>j.maxCommentLength?(O.innerHTML=H?.getAttribute("data-show")==="false"?R.slice(0,j.maxCommentLength)+"...":R,O.setAttribute("data-comment",v.base64Encode(R)),H?.classList.replace("d-none","d-block")):(O.innerHTML=R,O.removeAttribute("data-comment"),H?.classList.replace("d-block","d-none"))}if(s&&(document.getElementById("form-presence").value=t?"1":"2",C("information").set("presence",t)),!(!s||!$)){if(t){$.classList.remove("fa-circle-xmark","text-danger"),$.classList.add("fa-circle-check","text-success");return}$.classList.remove("fa-circle-check","text-success"),$.classList.add("fa-circle-xmark","text-danger")}}},cancel:a=>{let n=document.getElementById(`form-inner-presence-${a}`),t=n?n.value==="1":!1,s=document.getElementById(`badge-${a}`),g=s?s.classList.contains("text-success"):!1;if(D.isOpen(a)){(!D.getResultId(a)&&g===t||confirm("Are you sure?"))&&(D.remove(a),r(a,!1),document.getElementById(`inner-${a}`).remove());return}let $=document.getElementById(`form-inner-${a}`);($.value.length===0||v.base64Encode($.value)===$.getAttribute("data-original")&&g===t||confirm("Are you sure?"))&&(r(a,!1),document.getElementById(`inner-${a}`).remove())},show:M,showMore:(a,n)=>{let t=document.getElementById(`content-${n}`),s=v.base64Decode(t.getAttribute("data-comment")),g=a.getAttribute("data-show")==="false";t.innerHTML=g?s:s.slice(0,j.maxCommentLength)+"...",a.innerText=g?"Sebagian":"Selengkapnya",a.setAttribute("data-show",g?"true":"false")},showOrHide:c}})();var ie=(()=>{let m=()=>W.getDetailUser().then(l=>{document.getElementById("dashboard-name").innerHTML=`${v.escapeHtml(l.data.name)}<i class="fa-solid fa-hands text-warning ms-2"></i>`,document.getElementById("dashboard-email").innerHTML=l.data.email,document.getElementById("dashboard-accesskey").value=l.data.access_key,document.getElementById("button-copy-accesskey").setAttribute("data-copy",l.data.access_key),document.getElementById("form-name").value=v.escapeHtml(l.data.name),document.getElementById("filterBadWord").checked=!!l.data.is_filter,document.getElementById("replyComment").checked=!!l.data.can_reply,document.getElementById("editComment").checked=!!l.data.can_edit,document.getElementById("deleteComment").checked=!!l.data.can_delete,document.getElementById("dashboard-tenorkey").value=l.data.tenor_key,C("config").set("tenor_key",l.data.tenor_key)}),b=()=>{_(z,"/api/stats").token(L.getToken()).send().then(l=>{document.getElementById("count-comment").innerHTML=String(l.data.comments).replace(/\B(?=(\d{3})+(?!\d))/g,"."),document.getElementById("count-like").innerHTML=String(l.data.likes).replace(/\B(?=(\d{3})+(?!\d))/g,"."),document.getElementById("count-present").innerHTML=String(l.data.present).replace(/\B(?=(\d{3})+(?!\d))/g,"."),document.getElementById("count-absent").innerHTML=String(l.data.absent).replace(/\B(?=(\d{3})+(?!\d))/g,".")})},y=async l=>{let p=v.disableCheckbox(l);await _(G,"/api/user").token(L.getToken()).body({filter:!!l.checked}).send(),p.restore()},d=async l=>{let p=v.disableCheckbox(l);await _(G,"/api/user").token(L.getToken()).body({can_reply:!!l.checked}).send(),p.restore()},h=async l=>{let p=v.disableCheckbox(l);await _(G,"/api/user").token(L.getToken()).body({can_edit:!!l.checked}).send(),p.restore()},i=async l=>{let p=v.disableCheckbox(l);await _(G,"/api/user").token(L.getToken()).body({can_delete:!!l.checked}).send(),p.restore()},r=async l=>{let p=v.disableButton(l),E=document.getElementById("dashboard-tenorkey");E.disabled=!0,await _(G,"/api/user").token(L.getToken()).body({tenor_key:E.value.length?E.value:null}).send().then(()=>alert(`success ${E.value.length?"add":"remove"} tenor key`)),E.disabled=!1,p.restore()},f=async l=>{if(!confirm("Are you sure?"))return;let p=v.disableButton(l);await _(Y,"/api/key").token(L.getToken()).send(q.statusResponse).then(E=>{E.data.status&&m()}),p.restore()},I=async l=>{let p=document.getElementById("old_password"),E=document.getElementById("new_password");if(p.value.length===0||E.value.length===0){alert("Password cannot be empty");return}p.disabled=!0,E.disabled=!0;let N=v.disableButton(l),a=await _(G,"/api/user").token(L.getToken()).body({old_password:p.value,new_password:E.value}).send(q.statusResponse).then(n=>n.data.status,()=>!1);N.restore(),p.disabled=!1,E.disabled=!1,a&&(p.value=null,E.value=null,l.disabled=!0,alert("Success change password"))},T=async l=>{let p=document.getElementById("form-name");if(p.value.length===0){alert("Name cannot be empty");return}p.disabled=!0;let E=v.disableButton(l),N=await _(G,"/api/user").token(L.getToken()).body({name:p.value}).send(q.statusResponse).then(a=>a.data.status,()=>!1);p.disabled=!1,E.restore(),N&&(m(),l.disabled=!0,alert("Success change name"))},M=async l=>{let p=v.disableButton(l);await _(z,"/api/download").token(L.getToken()).download(),p.restore()},c=()=>{let l=document.getElementById("button-change-name");l.disabled&&(l.disabled=!1)},u=()=>{let l=document.getElementById("button-change-password"),p=document.getElementById("old_password");l.disabled&&p.value.length!==0&&(l.disabled=!1)},k=()=>{confirm("Are you sure?")&&W.clearSession()},x=()=>{oe.init(),Z.spyTop();let l=async()=>{await m(),b(),te.init(),te.show()};document.addEventListener("hidden.bs.modal",l);try{let p=window.location.href.split("?k=");p.length>1&&p[1].length>=1&&(L.setToken(p[1]),window.history.replaceState({},document.title,p[0]));let E=L.decode()?.exp;if(!E||E<Date.now()/1e3)throw new Error("Invalid token");l()}catch{W.clearSession()}};return{init:()=>(W.init(),Z.init(),L.init(),L.isAdmin()||(C("owns").clear(),C("likes").clear(),C("config").clear(),C("comment").clear(),C("session").clear(),C("information").clear()),window.addEventListener("DOMContentLoaded",x),{util:v,theme:Z,comment:te,admin:{auth:W,navbar:se,logout:k,tenor:r,download:M,regenerate:f,editComment:h,replyComment:d,deleteComment:i,changeName:T,changePassword:I,changeFilterBadWord:y,enableButtonName:c,enableButtonPassword:u}})}})();(m=>{m.undangan=ie.init()})(window);})();
